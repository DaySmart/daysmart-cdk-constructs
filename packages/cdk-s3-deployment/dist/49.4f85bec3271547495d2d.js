(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{Dvuq:function(t,n,e){"use strict";e.r(n),e.d(n,"ConsultationsModule",(function(){return R}));var o,i=e("tyNb"),r=e("IfdK"),c=e("2jMA"),a=e("PnPc"),s=e("Y9WU"),u=e("kuc9"),l=e("fXoL"),p=function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function c(t){try{s(o.next(t))}catch(n){r(n)}}function a(t){try{s(o.throw(t))}catch(n){r(n)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,a)}s((o=o.apply(t,n||[])).next())}))},f=function(t,n){var e,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=n.call(t,c)}catch(a){r=[6,a],o=0}finally{e=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},d=function(){function t(t){this.consultationApiService=t}return t.prototype.activateConsultationService=function(){return p(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.consultationApiService.activateConsultationService()];case 1:return[2,t.sent()]}}))}))},t.prototype.getAccount=function(){return p(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.consultationApiService.getAccount().toPromise()];case 1:return[2,t.sent()]}}))}))},t.\u0275fac=function(n){return new(n||t)(l.ac(u.a))},t.\u0275prov=l.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),g=e("p20J"),h=e("Coov"),b=e("rTmN"),m=e("0IaG"),v=e("weev"),y=(e("yh8A"),e("ofXK")),C=e("bTqV"),P=e("ccMj"),w=e("Xa2L"),_=(o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});function S(t,n){if(1&t&&(l.Vb(0,"li"),l.Vb(1,"span"),l.Vc(2),l.Ub(),l.Ub()),2&t){var e=n.$implicit;l.Cb(2),l.Wc(e)}}function O(t,n){if(1&t&&(l.Tb(0),l.Vc(1),l.Sb()),2&t){var e=l.ic();l.Cb(1),l.Xc(" ",e.data.actionBtnText," ")}}function M(t,n){1&t&&(l.Vb(0,"div",10),l.Qb(1,"mat-spinner",11),l.Ub()),2&t&&(l.Cb(1),l.qc("diameter",25))}var x=function(t){function n(n,e){var o=t.call(this,n,e)||this;return o.dialogRef=n,o.data=e,o.isLoading=!0,o.isActivating=!1,o}return _(n,t),n.prototype.action=function(){var t=this;this.isActivating=!0,this.dialogRef.disableClose=!0,this.data.action().then((function(n){t.isActivating=!1,t.dialogRef.close(!0)}))},n.prototype.ngOnInit=function(){t.prototype.ngOnInit.call(this)},n.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this)},Object.defineProperty(n.prototype,"imageUrl",{get:function(){if(this.data.imageName)return"assets/images/"+this.data.imageName+"_Promo.png"},enumerable:!1,configurable:!0}),n.\u0275fac=function(t){return new(t||n)(l.Pb(m.i),l.Pb(m.a))},n.\u0275cmp=l.Jb({type:n,selectors:[["consultations-promo-dialog-component"]],features:[l.zb],decls:19,vars:6,consts:[["id","promoImage",3,"src"],["mat-dialog-title","",1,"center-wrapper"],["mat-dialog-content","",1,"promo-content"],[1,"promo-list"],[4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"center-wrapper"],["qa","promo-dialog-ok-btn","mat-raised-button","","color","primary","cdkFocusInitial","",1,"activate",3,"click"],[4,"ngIf"],["class","activate-spinner",4,"ngIf"],["qa","promo-dialog-close-btn","id","close",3,"mat-dialog-close"],[1,"activate-spinner"],[3,"diameter"]],template:function(t,n){1&t&&(l.Qb(0,"img",0),l.Vb(1,"h1",1),l.Vc(2,"Tele-Consult to "),l.Qb(3,"br"),l.Vc(4," Stay in Touch"),l.Ub(),l.Vb(5,"div",2),l.Vb(6,"p"),l.Vc(7),l.Ub(),l.Vb(8,"div",3),l.Vb(9,"ul"),l.Tc(10,S,3,1,"li",4),l.Ub(),l.Ub(),l.Ub(),l.Vb(11,"div",5),l.Vb(12,"div"),l.Vb(13,"button",6),l.ec("click",(function(){return n.action()})),l.Tc(14,O,2,1,"ng-container",7),l.Tc(15,M,2,1,"div",8),l.Ub(),l.Ub(),l.Vb(16,"div"),l.Vb(17,"button",9),l.Vc(18,"Remind me later"),l.Ub(),l.Ub(),l.Ub()),2&t&&(l.qc("src",n.imageUrl,l.Kc),l.Cb(7),l.Xc("Conduct video consultations from within ",n.data.program,""),l.Cb(3),l.qc("ngForOf",n.data.benefits),l.Cb(4),l.qc("ngIf",!n.isActivating),l.Cb(1),l.qc("ngIf",n.isActivating),l.Cb(2),l.qc("mat-dialog-close",!1))},directives:[m.j,m.g,y.s,m.c,C.b,P.b,y.t,m.d,w.c],styles:['.promo-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.promo-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-left:1.3em;font-size:15px;line-height:44px}.promo-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{vertical-align:middle}.promo-content[_ngcontent-%COMP%]   li.benefit[_ngcontent-%COMP%]:before{content:"done";font-family:Material Icons;font-size:30px;display:inline-block;margin-left:-1.3em;width:1.3em;vertical-align:middle}.promo-content[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]{margin:0}.mat-dialog-title[_ngcontent-%COMP%]{font-size:26px;padding:20px 0 10px;margin:0}.center-wrapper[_ngcontent-%COMP%]{float:none;width:100%;justify-content:center;text-align:center}.center-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:1rem 0}','.posonline-promo-dialog[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]{margin-right:0}#promoImage[_ngcontent-%COMP%]{width:850px}.mat-dialog-title[_ngcontent-%COMP%]{font-size:24px}.small-title[_ngcontent-%COMP%]{font-size:20px}.promo-content[_ngcontent-%COMP%]   .promo-list[_ngcontent-%COMP%]{-moz-column-count:2;column-count:2;margin-left:185px;margin-bottom:10px}.promo-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:disc;line-height:25px;text-align:left;padding:0}.promo-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"";text-align:left}.center-wrapper[_ngcontent-%COMP%]   .activate[_ngcontent-%COMP%]{width:160px}.center-wrapper[_ngcontent-%COMP%]   .activate[_ngcontent-%COMP%]   .activate-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;width:160px}']}),n}(v.a),k=e("Xaoa"),T=e("pMDz"),A=function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function c(t){try{s(o.next(t))}catch(n){r(n)}}function a(t){try{s(o.throw(t))}catch(n){r(n)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,a)}s((o=o.apply(t,n||[])).next())}))},I=function(t,n){var e,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=n.call(t,c)}catch(a){r=[6,a],o=0}finally{e=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};function V(t,n){if(1&t&&(l.Vb(0,"div",2),l.Qb(1,"iframe",3),l.jc(2,"safeResourceUrl"),l.Ub()),2&t){var e=l.ic();l.Cb(1),l.qc("src",l.kc(2,1,e.iframePath),l.Jc)}}function U(t,n){1&t&&(l.Vb(0,"div",4),l.Qb(1,"mat-spinner",5),l.Ub()),2&t&&(l.Cb(1),l.qc("diameter",125))}var L=function(){function t(t,n,e,o,i,r,c,a,s,u,l){this.permissionsService=t,this.sessionService=n,this.daysmartProductService=e,this.redirectService=o,this.envConfigLoader=i,this.analyticsService=r,this.consultationService=c,this.snackBar=a,this.featureService=s,this.dialog=u,this.router=l,this.count=0}return t.prototype.ngOnInit=function(){this.loadIFrame=!1;var t=this.permissionsService.isConsultationServiceSubscriptionActive();this.featureService.getFeatureFlag(b.a.ConsultationsPromo)&&!t?this.LoadPromoDialog():this.getDetails()},t.prototype.LoadPromoDialog=function(){var t=this;this.dialog.open(x,{data:{title:"Tele-Consultations",benefits:["Styling product or hair repair","Hair color consultations","Hair color application lessons","Makeup consults and lessons","Hair blow drying lessons","Share basic men's cutting tips","Share basic bang trimming tips","Meet 1:1 with your team!"],actionBtnText:"Activate Service",imageName:this.sessionService.customerInfo.customer_program_name+"_Consultations",program:this.getProgramTitle(),action:function(){return t.consultationService.activateConsultationService().then((function(n){t.sessionService.updateSession()}))}},panelClass:"posonline-promo-dialog",disableClose:!0}).afterClosed().subscribe((function(n){n?(t.isLoading=!0,t.getAccountNameWithRetries()):t.router.navigate(["/Service"])}))},t.prototype.getProgramTitle=function(){var t=this.permissionsService.getProduct();return this.daysmartProductService.getProductShortNameByType(t)},t.prototype.getAccountNameWithRetries=function(){return A(this,void 0,void 0,(function(){var t;return I(this,(function(n){return t=this,[2,new Promise((function(n,e){return A(this,void 0,void 0,(function(){return I(this,(function(e){return setTimeout((function(){return A(this,void 0,void 0,(function(){var e;return I(this,(function(o){switch(o.label){case 0:return t.count++,e=t,[4,t.consultationService.getAccount()];case 1:return e.account=o.sent(),t.account&&t.account.data?(t.getDetails(),n()):16===t.count?(t.accountNotFound(),n()):n(t.getAccountNameWithRetries()),[2]}}))}))}),1500),[2]}))}))}))]}))}))},t.prototype.getDetails=function(){return A(this,void 0,void 0,(function(){var t,n,e,o,i,r;return I(this,(function(c){switch(c.label){case 0:return this.loadIFrame=!0,this.isLoading=!0,t=this.sessionService.customerInfo.customer_id,n=this.sessionService.sessionKey,e="local_api"===this.envConfigLoader.getEnvConfig().env?"dev":this.envConfigLoader.getEnvConfig().env,o=this.redirectService.getCurrentDomain(),this.account&&this.account.data?[3,2]:(i=this,[4,this.consultationService.getAccount()]);case 1:i.account=c.sent(),c.label=2;case 2:return this.isLoading=!1,(r=this.account.data)||this.accountNotFound(),this.iframePath="https://consult."+o+"/"+r+"/staff_appointments?customer_id="+t+"&session_key="+n+"&env="+e,this.analyticsService.trackEvent("[Tele-Consultation] View Page"),[2]}}))}))},t.prototype.accountNotFound=function(){this.router.navigate(["/Service"]),this.snackBar.open("Unable to find Tele-Consulation account. Please try again.","",{duration:5e3})},t.\u0275fac=function(n){return new(n||t)(l.Pb(h.c),l.Pb(r.a),l.Pb(k.b),l.Pb(c.a),l.Pb(a.a),l.Pb(s.a),l.Pb(d),l.Pb(g.a),l.Pb(b.b),l.Pb(m.b),l.Pb(i.g))},t.\u0275cmp=l.Jb({type:t,selectors:[["consultations"]],decls:2,vars:2,consts:[["id","iframeContainer",4,"ngIf"],["class","row-spinner-container",4,"ngIf"],["id","iframeContainer"],["allow","camera;microphone","frameborder","0",3,"src"],[1,"row-spinner-container"],["color","primary",3,"diameter"]],template:function(t,n){1&t&&(l.Tc(0,V,3,3,"div",0),l.Tc(1,U,2,1,"div",1)),2&t&&(l.qc("ngIf",!n.isLoading&&n.loadIFrame),l.Cb(1),l.qc("ngIf",n.isLoading))},directives:[y.t,w.c],pipes:[T.a],styles:["#iframeContainer[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%}#iframeContainer[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:calc(100vh - 60px)}"]}),t}(),N=function(){function t(t,n,e){this.permissionsService=t,this.snackBar=n,this.router=e}return t.prototype.canActivateChild=function(t){if(!this.permissionsService.isBilledThroughZuora())return this.redirectToServices(),!1;var n=this.permissionsService.hasEmployeePermission(h.a.ConsultationsScreen);return n||(this.snackBar.open("You do not have permission to view Tele-Consultations.","",{duration:5e3}),this.redirectToServices()),n},t.prototype.redirectToServices=function(){this.router.navigate(["/Service"])},t.\u0275fac=function(n){return new(n||t)(l.ac(h.c),l.ac(g.a),l.ac(i.g))},t.\u0275prov=l.Lb({token:t,factory:t.\u0275fac}),t}(),q=[{path:"",canActivate:[e("bcfW").b],canActivateChild:[N],component:L,children:[{path:"",component:L,data:{key:"ConsultationsPage"},pathMatch:"full"}]}],j=function(){function t(){}return t.\u0275mod=l.Nb({type:t}),t.\u0275inj=l.Mb({factory:function(n){return new(n||t)},imports:[[i.k.forChild(q)],i.k]}),t}(),F=e("PCNd"),D=e("9Rcy"),R=function(){function t(){}return t.\u0275mod=l.Nb({type:t}),t.\u0275inj=l.Mb({factory:function(n){return new(n||t)},providers:[d,N],imports:[[y.c,D.a,j,F.a]]}),t}()}}]);