(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/vjp":function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var i=n("fXoL"),r=n("IfdK"),a=n("brfy"),o=n("ofXK"),c=n("0IaG"),s=n("+0xr"),l=n("wCJe"),u=n("wVB6"),d=n("j4OF"),p=n("qEEV"),h=n("p20J"),f=n("XNiG"),m=n("1G5W"),b=n("16fB"),g=n("3Pt+"),v=n("fCrE"),C=n("f0Cb"),y=n("bTqV"),k=n("ccMj"),x=n("Xa2L");function S(e,t){if(1&e&&(i.Vb(0,"button",8),i.Vc(1,"Add"),i.Ub()),2&e){var n=i.ic();i.qc("disabled",n.isLoading)}}function _(e,t){1&e&&(i.Vb(0,"button",9),i.Vb(1,"div",10),i.Qb(2,"mat-spinner",11),i.Ub(),i.Ub()),2&e&&(i.Cb(2),i.qc("diameter",23))}var w=function(){function e(e,t,n,i,r){this.dialogRef=e,this.fb=t,this.cardOnFileService=n,this.errorDialogService=i,this.data=r,this.isLoading=!0,this.ngUnsubscribe=new f.a}return Object.defineProperty(e.prototype,"tokenizationFormGroupName",{get:function(){return"tokenization-fields"},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.form=this.fb.group({}),this.form.statusChanges.pipe(Object(m.a)(this.ngUnsubscribe)).subscribe((function(){e.form.invalid&&(e.isAdding=!1)}))},e.prototype.onSubmit=function(){return e=this,void 0,n=function(){var e,t,n,i,r,a,o,c;return function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(s){switch(s.label){case 0:if(!this.form.valid)return[3,5];e=void 0,this.isAdding=!0,s.label=1;case 1:return s.trys.push([1,3,,4]),t=this.form.get(this.tokenizationFormGroupName),n=t.get("nameOnCard").value,i=t.get("cardToken").value,r=t.get("zipCode").value,a=t.get("cardExpiration").value.match(/.{2}/g),[4,this.cardOnFileService.add(this.data.clientID,i,r,n,a[0],a[1])];case 2:return e=s.sent(),[3,4];case 3:return o=s.sent(),console.error(o),c="An error occurred, please try again.",400===o.HttpStatus&&(c=o.StatusMessage),this.errorDialogService.openHandledErrorDialog(c),this.isAdding=!1,[2];case 4:return this.dialogRef.close({creditCard:e}),[3,6];case 5:this.form.markAllAsTouched(),s.label=6;case 6:return[2]}}))},new((t=void 0)||(t=Promise))((function(i,r){function a(e){try{c(n.next(e))}catch(t){r(t)}}function o(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,o)}c((n=n.apply(e,[])).next())}));var e,t,n},e.prototype.tokenizerInitialized=function(){this.isLoading=!1},e.prototype.onCancel=function(){this.dialogRef.close(null)},e.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},e.\u0275fac=function(t){return new(t||e)(i.Pb(c.i),i.Pb(g.h),i.Pb(b.a),i.Pb(p.a),i.Pb(c.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["add-card-on-file-dialog"]],decls:11,vars:5,consts:[[1,"dialog-title"],[1,"form-container",3,"formGroup","submit"],[1,"form-wrapper"],[3,"tokenizationFormGroupName","tokenizerInitialized"],[1,"btn-controls"],["mat-raised-button","","type","button",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit","qa","add-new-card-on-file-card-connect",3,"disabled",4,"ngIf"],["mat-raised-button","","color","primary","type","button",4,"ngIf"],["mat-raised-button","","color","primary","type","submit","qa","add-new-card-on-file-card-connect",3,"disabled"],["mat-raised-button","","color","primary","type","button"],[1,"spinner"],[3,"diameter"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vc(1,"Add New Card"),i.Ub(),i.Vb(2,"form",1),i.ec("submit",(function(){return t.onSubmit()})),i.Vb(3,"div",2),i.Vb(4,"card-connect-tokenization-form-fields",3),i.ec("tokenizerInitialized",(function(){return t.tokenizerInitialized()})),i.Ub(),i.Ub(),i.Qb(5,"mat-divider"),i.Vb(6,"div",4),i.Vb(7,"button",5),i.ec("click",(function(){return t.onCancel()})),i.Vc(8,"Cancel"),i.Ub(),i.Tc(9,S,2,1,"button",6),i.Tc(10,_,3,1,"button",7),i.Ub(),i.Ub()),2&e&&(i.Cb(2),i.qc("formGroup",t.form),i.Cb(2),i.qc("tokenizationFormGroupName",t.tokenizationFormGroupName),i.Cb(3),i.qc("disabled",t.isAdding),i.Cb(2),i.qc("ngIf",!t.isAdding),i.Cb(1),i.qc("ngIf",t.isAdding))},directives:[g.L,g.w,g.m,v.a,C.a,y.b,o.t,k.b,x.c],styles:[".dialog-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.form-container[_ngcontent-%COMP%]{margin-top:20px;min-width:415px}.form-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{margin-bottom:5px;display:flex;gap:5px 20px;flex-wrap:wrap}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{display:flex;align-items:center;height:36px}"]}),e}(),P=n("HDqe"),M=n("NFeN"),O=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},V=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function I(e,t){1&e&&(i.Vb(0,"div",4),i.Vc(1,"No card added yet!"),i.Ub())}function D(e,t){1&e&&(i.Vb(0,"mat-icon",18),i.Vc(1," credit_card "),i.Ub()),2&e&&i.qc("inline",!0)}function T(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-cell"),i.Vb(1,"img",15,16),i.ec("error",(function(){return i.Hc(n),i.Dc(2).hidden=!0})),i.Ub(),i.Tc(3,D,2,1,"mat-icon",17),i.Ub()}if(2&e){var r=t.$implicit,a=i.Dc(2),o=i.ic(2);i.Cb(1),i.qc("src","./assets/resources/credit-card-processing/"+o.creditCardType[r.type]+".png",i.Kc),i.Cb(2),i.qc("ngIf",a.hidden)}}function E(e,t){if(1&e&&(i.Vb(0,"mat-cell",19),i.Vc(1),i.Ub()),2&e){var n=t.$implicit;i.Cb(1),i.Xc(" Ending in ",n.last4Digits," ")}}function q(e,t){if(1&e&&(i.Vb(0,"mat-cell",20),i.Vc(1),i.jc(2,"number"),i.jc(3,"number"),i.Ub()),2&e){var n=t.$implicit;i.Cb(1),i.Yc(" Exp ",i.lc(2,2,n.expirationMonth,"2.0-0"),"/",i.lc(3,5,n.expirationYear,"2.0-0")," ")}}function A(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-icon",24),i.ec("click",(function(e){i.Hc(n);var t=i.ic().$implicit,r=i.ic(2);return e.stopPropagation(),r.onDelete(t)})),i.Vc(1," delete_forever "),i.Ub()}}function U(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"mat-spinner",25),i.Ub()),2&e&&(i.Cb(1),i.qc("diameter",23))}function N(e,t){if(1&e&&(i.Vb(0,"mat-cell"),i.Vb(1,"div",21),i.Tc(2,A,2,0,"mat-icon",22),i.Tc(3,U,2,1,"div",23),i.Ub(),i.Ub()),2&e){var n=t.$implicit,r=i.ic(2);i.Cb(2),i.qc("ngIf",!r.isCardBeingDeleted(n.id)),i.Cb(1),i.qc("ngIf",r.isCardBeingDeleted(n.id))}}function R(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-cell"),i.Vb(1,"div",21),i.Vb(2,"a",26),i.ec("click",(function(){i.Hc(n);var e=t.$implicit;return i.ic(2).onUseCard(e)})),i.Vc(3,"Use this card"),i.Ub(),i.Ub(),i.Ub()}}function z(e,t){1&e&&i.Qb(0,"mat-row",27)}function F(e,t){if(1&e&&(i.Vb(0,"mat-table",5),i.Tb(1,6),i.Tc(2,T,4,2,"mat-cell",7),i.Sb(),i.Tb(3,8),i.Tc(4,E,2,1,"mat-cell",9),i.Sb(),i.Tb(5,10),i.Tc(6,q,4,8,"mat-cell",11),i.Sb(),i.Tb(7,12),i.Tc(8,N,4,2,"mat-cell",7),i.Sb(),i.Tb(9,13),i.Tc(10,R,4,0,"mat-cell",7),i.Sb(),i.Tc(11,z,1,0,"mat-row",14),i.Ub()),2&e){var n=i.ic();i.qc("dataSource",n.dataSource),i.Cb(11),i.qc("matRowDefColumns",n.displayedColumns)}}function L(e,t){if(1&e){var n=i.Wb();i.Vb(0,"button",28),i.ec("click",(function(){return i.Hc(n),i.ic().onAddNewCard()})),i.Vc(1," + Add New Card\n"),i.Ub()}}var j=function(){function e(e,t,n,r,a){this.dialog=e,this.cardOnFileService=t,this.cardConnectSettingsService=n,this.snackbarService=r,this.errorDialogService=a,this.useCard=new i.o,this.displayedColumns=["cardType","last4Digits","expireDate","deleteAction"],this.cardsBeingDeleted=new Set,this.ngUnsubscribe=new f.a}return Object.defineProperty(e.prototype,"clientID",{get:function(){return this._clientID},set:function(e){this._clientID=e,this.loadList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showUseCardButton",{set:function(e){var t="useCardAction";if(e)this.displayedColumns.includes(t)||this.displayedColumns.push(t);else{var n=this.displayedColumns.indexOf(t);n>-1&&this.displayedColumns.splice(n,1)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDialogOpen",{get:function(){return!!this.addDialogRef&&2!==this.addDialogRef.getState()||!!this.deleteDialogRef&&2!==this.deleteDialogRef.getState()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardType",{get:function(){return u.a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return!this.dataSource},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.cardConnectSettingsService.getSettings().pipe(Object(m.a)(this.ngUnsubscribe)).subscribe((function(t){e.businessMerchantID=t.merchantID,e.loadList()}))},e.prototype.loadList=function(){var e,t;return O(this,void 0,void 0,(function(){var n,i=this;return V(this,(function(r){switch(r.label){case 0:if(!(null===(e=this.businessMerchantID)||void 0===e?void 0:e.length)||!this.clientID||this.clientID<1)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.cardOnFileService.getList(this.clientID)];case 2:return n=r.sent(),this.dataSource=new s.p,this.dataSource.data=null!==(t=n.map((function(e){return i.translateToListCardOnFile(e)})))&&void 0!==t?t:[],[3,4];case 3:return r.sent(),this.snackbarService.open("We were unable to load this client's card on file list."),[3,4];case 4:return[2]}}))}))},e.prototype.onUseCard=function(e){this.useCard.emit(e)},e.prototype.onAddNewCard=function(){this.isLoading||this.isDialogOpen||this.openAddCardDialog()},e.prototype.openAddCardDialog=function(){var e=this,t=new c.e;t.disableClose=!0,t.autoFocus=!1,t.hasBackdrop=!0,t.width="585px",t.height="305px",t.data={clientID:this.clientID,businessMerchantID:this.businessMerchantID},this.addDialogRef=this.dialog.open(w,t),this.addDialogRef.afterClosed().subscribe((function(t){var n,i;if(null===(i=null===(n=null==t?void 0:t.creditCard)||void 0===n?void 0:n.accountId)||void 0===i?void 0:i.length){var r=e.translateToListCardOnFile(t.creditCard);e.dataSource.data.push(r),e.dataSource.data=e.dataSource.data}}))},e.prototype.onDelete=function(e){var t=this;this.isDialogOpen||(this.deleteDialogRef=this.dialog.open(l.a,{data:{title:"Delete Card on File?",content:"Are you sure you want to delete this card?",noText:"No",yesText:"Yes"},panelClass:"posonline-discard-draft-dialog"}),this.deleteDialogRef.afterClosed().subscribe((function(n){return O(t,void 0,void 0,(function(){return V(this,(function(t){switch(t.label){case 0:return t.trys.push([0,,3,4]),n?(this.cardsBeingDeleted.add(e.id),[4,this.deleteCardOnFile(e.id)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return this.cardsBeingDeleted.delete(e.id),[7];case 4:return[2]}}))}))})))},e.prototype.deleteCardOnFile=function(e){return O(this,void 0,void 0,(function(){var t,n,i;return V(this,(function(r){switch(r.label){case 0:t=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.cardOnFileService.delete(e,this.clientID)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),console.error(n),i="An error occurred, please try again.",400===n.HttpStatus&&(i=n.StatusMessage),this.errorDialogService.openHandledErrorDialog(i),[3,4];case 4:return t&&(this.dataSource.data=this.dataSource.data.filter((function(t){return t.id!==e}))),[2]}}))}))},e.prototype.isCardBeingDeleted=function(e){return this.cardsBeingDeleted.has(e)},e.prototype.translateToListCardOnFile=function(e){return{id:e.accountId,last4Digits:e.last4Digits,expirationMonth:e.expireMonth,expirationYear:parseInt(e.expireYear.toString().slice(-2)),type:e.type,token:e.token}},e.\u0275fac=function(t){return new(t||e)(i.Pb(c.b),i.Pb(b.a),i.Pb(d.a),i.Pb(h.a),i.Pb(p.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["card-on-file-list-card-connect"]],inputs:{clientID:"clientID",showUseCardButton:"showUseCardButton",showAddCardButton:"showAddCardButton"},outputs:{useCard:"useCard"},decls:4,vars:6,consts:[["skeletonTable","",3,"showSkeleton","skeletonTableRowAmount","placeholderHeight"],["class","empty-state","qa","no-card-on-file-text",4,"ngIf"],["class","list-container",3,"dataSource",4,"ngIf"],["mat-button","","color","primary","type","button","onclick","this.blur()","qa","add-new-card-on-file-paysafe","class","add-new-card-button",3,"click",4,"ngIf"],["qa","no-card-on-file-text",1,"empty-state"],[1,"list-container",3,"dataSource"],["matColumnDef","cardType"],[4,"matCellDef"],["matColumnDef","last4Digits"],["qa","card-on-file-list-cell-last-four",4,"matCellDef"],["matColumnDef","expireDate"],["qa","card-on-file-list-cell-exp",4,"matCellDef"],["matColumnDef","deleteAction"],["matColumnDef","useCardAction"],["class","table-row",4,"matRowDef","matRowDefColumns"],[3,"src","error"],["img",""],["class","material-icons bad-cc-image-icon",3,"inline",4,"ngIf"],[1,"material-icons","bad-cc-image-icon",3,"inline"],["qa","card-on-file-list-cell-last-four"],["qa","card-on-file-list-cell-exp"],[1,"icon-container"],["color","primary","class","material-icons btn-icon",3,"click",4,"ngIf"],[4,"ngIf"],["color","primary",1,"material-icons","btn-icon",3,"click"],[3,"diameter"],["mat-button","","color","primary","qa","btn-use-this-card-connect",1,"use-card-button",3,"click"],[1,"table-row"],["mat-button","","color","primary","type","button","onclick","this.blur()","qa","add-new-card-on-file-paysafe",1,"add-new-card-button",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Tc(1,I,2,0,"div",1),i.Tc(2,F,12,2,"mat-table",2),i.Ub(),i.Tc(3,L,2,0,"button",3)),2&e&&(i.qc("showSkeleton",t.isLoading)("skeletonTableRowAmount",3)("placeholderHeight","30px"),i.Cb(1),i.qc("ngIf",t.dataSource&&0===t.dataSource.data.length),i.Cb(1),i.qc("ngIf",t.dataSource&&t.dataSource.data.length>0),i.Cb(1),i.qc("ngIf",t.showAddCardButton))},directives:[P.d,o.t,k.b,s.o,s.c,s.b,s.n,s.a,M.a,x.c,y.a,s.m,y.b],pipes:[o.g],styles:[".list-container[_ngcontent-%COMP%]{font-size:16px;margin:8px 0 3px;width:100%;max-height:150px;overflow-y:auto}.list-container[_ngcontent-%COMP%]   mat-row[_ngcontent-%COMP%]{border-bottom-style:none}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{flex:none;padding:0 15px 0 0}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]{padding-right:10px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:3px;height:30px;width:50px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]   .bad-cc-image-icon[_ngcontent-%COMP%]{font-size:50px;width:50px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-last4Digits[_ngcontent-%COMP%]{width:110px}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:0}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     .mat-button-focus-overlay{background:none}.empty-state[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);font-size:18px;font-style:italic;margin:20px 0 13px}.add-new-card-button[_ngcontent-%COMP%]{font-size:16px}"]}),e}(),H=n("pE+g"),$=n("LimZ"),B=n("gzIF");function G(e,t){if(1&e&&(i.Vb(0,"button",8),i.Vc(1,"Add"),i.Ub()),2&e){var n=i.ic();i.qc("disabled",n.isLoading)}}function J(e,t){1&e&&(i.Vb(0,"button",9),i.Vb(1,"div",10),i.Qb(2,"mat-spinner",11),i.Ub(),i.Ub()),2&e&&(i.Cb(2),i.qc("diameter",23))}var Q=function(){function e(e,t,n,i,r,a){this.dialogRef=e,this.fb=t,this.cardOnFileService=n,this.session=i,this.errorDialogService=r,this.data=a,this.isLoading=!0,this.ngUnsubscribe=new f.a}return Object.defineProperty(e.prototype,"tokenizationFormGroupName",{get:function(){return"tokenization-fields"},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.form=this.fb.group({}),this.form.statusChanges.pipe(Object(m.a)(this.ngUnsubscribe)).subscribe((function(){e.form.invalid&&(e.isAdding=!1)}))},e.prototype.onSubmit=function(){this.form.valid?this.isAdding=!0:this.form.markAllAsTouched()},e.prototype.tokenizerInitialized=function(){this.isLoading=!1},e.prototype.cardTokenized=function(e){return t=this,void 0,i=function(){var t,n;return function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cardOnFileService.add(this.data.businessMerchantID,e,this.session.customerInfo.customer_culture_code,this.data.clientGuid)];case 1:return t=i.sent(),[3,3];case 2:return n=i.sent(),this.errorDialogService.openHandledErrorDialog(n.message),this.isAdding=!1,[2];case 3:return this.dialogRef.close({creditCard:t}),[2]}}))},new((n=void 0)||(n=Promise))((function(e,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function o(e){try{c(i.throw(e))}catch(t){r(t)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(a,o)}c((i=i.apply(t,[])).next())}));var t,n,i},e.prototype.cardTokenizationFailed=function(e){this.errorDialogService.openHandledErrorDialog(e)},e.prototype.onCancel=function(){this.dialogRef.close(null)},e.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},e.\u0275fac=function(t){return new(t||e)(i.Pb(c.i),i.Pb(g.h),i.Pb($.a),i.Pb(r.a),i.Pb(p.a),i.Pb(c.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["add-card-on-file-dialog"]],decls:11,vars:5,consts:[[1,"dialog-title"],[1,"form-container",3,"formGroup","submit"],[1,"form-wrapper"],[3,"tokenizationFormGroupName","tokenizerInitialized","cardTokenized","cardTokenizationFailed"],[1,"btn-controls"],["mat-raised-button","","type","button",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit","qa","add-card-on-file-paysafe-appt",3,"disabled",4,"ngIf"],["mat-raised-button","","color","primary","type","button",4,"ngIf"],["mat-raised-button","","color","primary","type","submit","qa","add-card-on-file-paysafe-appt",3,"disabled"],["mat-raised-button","","color","primary","type","button"],[1,"spinner"],[3,"diameter"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vc(1,"Add New Card"),i.Ub(),i.Vb(2,"form",1),i.ec("submit",(function(){return t.onSubmit()})),i.Vb(3,"div",2),i.Vb(4,"paysafe-tokenization-form-fields",3),i.ec("tokenizerInitialized",(function(){return t.tokenizerInitialized()}))("cardTokenized",(function(e){return t.cardTokenized(e)}))("cardTokenizationFailed",(function(e){return t.cardTokenizationFailed(e)})),i.Ub(),i.Ub(),i.Qb(5,"mat-divider"),i.Vb(6,"div",4),i.Vb(7,"button",5),i.ec("click",(function(){return t.onCancel()})),i.Vc(8,"Cancel"),i.Ub(),i.Tc(9,G,2,1,"button",6),i.Tc(10,J,3,1,"button",7),i.Ub(),i.Ub()),2&e&&(i.Cb(2),i.qc("formGroup",t.form),i.Cb(2),i.qc("tokenizationFormGroupName",t.tokenizationFormGroupName),i.Cb(3),i.qc("disabled",t.isAdding),i.Cb(2),i.qc("ngIf",!t.isAdding),i.Cb(1),i.qc("ngIf",t.isAdding))},directives:[g.L,g.w,g.m,B.a,C.a,y.b,o.t,k.b,x.c],styles:[".dialog-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.form-container[_ngcontent-%COMP%]{margin-top:20px;min-width:415px}.form-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{margin-bottom:5px;display:flex;gap:5px 20px;flex-wrap:wrap}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.form-container[_ngcontent-%COMP%]   .btn-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{display:flex;align-items:center;height:36px}"]}),e}(),Z=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},W=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function X(e,t){1&e&&(i.Vb(0,"div",4),i.Vc(1,"No card added yet!"),i.Ub())}function Y(e,t){1&e&&(i.Vb(0,"mat-icon",18),i.Vc(1," credit_card "),i.Ub()),2&e&&i.qc("inline",!0)}function K(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-cell"),i.Vb(1,"img",15,16),i.ec("error",(function(){return i.Hc(n),i.Dc(2).hidden=!0})),i.Ub(),i.Tc(3,Y,2,1,"mat-icon",17),i.Ub()}if(2&e){var r=t.$implicit,a=i.Dc(2),o=i.ic(2);i.Cb(1),i.qc("src","./assets/resources/credit-card-processing/"+o.creditCardType[r.type]+".png",i.Kc),i.Cb(2),i.qc("ngIf",a.hidden)}}function ee(e,t){if(1&e&&(i.Vb(0,"mat-cell",19),i.Vc(1),i.Ub()),2&e){var n=t.$implicit;i.Cb(1),i.Xc(" Ending in ",n.last4Digits," ")}}function te(e,t){if(1&e&&(i.Vb(0,"mat-cell",20),i.Vc(1),i.jc(2,"number"),i.jc(3,"number"),i.Ub()),2&e){var n=t.$implicit;i.Cb(1),i.Yc(" Exp ",i.lc(2,2,n.expirationMonth,"2.0-0"),"/",i.lc(3,5,n.expirationYear,"2.0-0")," ")}}function ne(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-icon",24),i.ec("click",(function(e){i.Hc(n);var t=i.ic().$implicit,r=i.ic(2);return e.stopPropagation(),r.onDelete(t)})),i.Vc(1," delete_forever "),i.Ub()}}function ie(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"mat-spinner",25),i.Ub()),2&e&&(i.Cb(1),i.qc("diameter",23))}function re(e,t){if(1&e&&(i.Vb(0,"mat-cell"),i.Vb(1,"div",21),i.Tc(2,ne,2,0,"mat-icon",22),i.Tc(3,ie,2,1,"div",23),i.Ub(),i.Ub()),2&e){var n=t.$implicit,r=i.ic(2);i.Cb(2),i.qc("ngIf",!r.isCardBeingDeleted(n.id)),i.Cb(1),i.qc("ngIf",r.isCardBeingDeleted(n.id))}}function ae(e,t){if(1&e){var n=i.Wb();i.Vb(0,"mat-cell"),i.Vb(1,"div",21),i.Vb(2,"a",26),i.ec("click",(function(){i.Hc(n);var e=t.$implicit;return i.ic(2).onUseCard(e)})),i.Vc(3,"Use this card"),i.Ub(),i.Ub(),i.Ub()}}function oe(e,t){1&e&&i.Qb(0,"mat-row",27)}function ce(e,t){if(1&e&&(i.Vb(0,"mat-table",5),i.Tb(1,6),i.Tc(2,K,4,2,"mat-cell",7),i.Sb(),i.Tb(3,8),i.Tc(4,ee,2,1,"mat-cell",9),i.Sb(),i.Tb(5,10),i.Tc(6,te,4,8,"mat-cell",11),i.Sb(),i.Tb(7,12),i.Tc(8,re,4,2,"mat-cell",7),i.Sb(),i.Tb(9,13),i.Tc(10,ae,4,0,"mat-cell",7),i.Sb(),i.Tc(11,oe,1,0,"mat-row",14),i.Ub()),2&e){var n=i.ic();i.qc("dataSource",n.dataSource),i.Cb(11),i.qc("matRowDefColumns",n.displayedColumns)}}function se(e,t){if(1&e){var n=i.Wb();i.Vb(0,"button",28),i.ec("click",(function(){return i.Hc(n),i.ic().onAddNewCard()})),i.Vc(1," + Add New Card\n"),i.Ub()}}var le=function(){function e(e,t,n,r,a){this.dialog=e,this.cardOnFileService=t,this.paysafeSettingsService=n,this.snackbarService=r,this.errorDialogService=a,this.useCard=new i.o,this.displayedColumns=["cardType","last4Digits","expireDate","deleteAction"],this.cardsBeingDeleted=new Set,this.ngUnsubscribe=new f.a}return Object.defineProperty(e.prototype,"clientGuid",{get:function(){return this._clientGuid},set:function(e){this._clientGuid=e,this.loadList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showUseCardButton",{set:function(e){var t="useCardAction";if(e)this.displayedColumns.includes(t)||this.displayedColumns.push(t);else{var n=this.displayedColumns.indexOf(t);n>-1&&this.displayedColumns.splice(n,1)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDialogOpen",{get:function(){return!!this.addDialogRef&&2!==this.addDialogRef.getState()||!!this.deleteDialogRef&&2!==this.deleteDialogRef.getState()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardType",{get:function(){return u.a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return!this.dataSource},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.paysafeSettingsService.getSettings().pipe(Object(m.a)(this.ngUnsubscribe)).subscribe((function(t){e.businessMerchantID=t.paysafeSettings.paysafeMerchantID,e.loadList()}))},e.prototype.loadList=function(){var e,t,n;return Z(this,void 0,void 0,(function(){var i,r=this;return W(this,(function(a){switch(a.label){case 0:if(!(null===(e=this.businessMerchantID)||void 0===e?void 0:e.length)||!(null===(t=this.clientGuid)||void 0===t?void 0:t.length))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.cardOnFileService.getList(this.businessMerchantID,this.clientGuid)];case 2:return i=a.sent(),this.dataSource=new s.p,this.dataSource.data=null!==(n=i.map((function(e){return r.translateToListCardOnFile(e)})))&&void 0!==n?n:[],[3,4];case 3:return a.sent(),this.snackbarService.open("We were unable to load this client's card on file list."),[3,4];case 4:return[2]}}))}))},e.prototype.onUseCard=function(e){this.useCard.emit(e)},e.prototype.onAddNewCard=function(){this.isLoading||this.isDialogOpen||this.openAddCardDialog()},e.prototype.openAddCardDialog=function(){var e=this,t=new c.e;t.disableClose=!0,t.autoFocus=!1,t.hasBackdrop=!0,t.width="585px",t.height="305px",t.data={clientGuid:this.clientGuid,businessMerchantID:this.businessMerchantID},this.addDialogRef=this.dialog.open(Q,t),this.addDialogRef.afterClosed().subscribe((function(t){var n,i;if(null===(i=null===(n=null==t?void 0:t.creditCard)||void 0===n?void 0:n.id)||void 0===i?void 0:i.length){var r=e.translateToListCardOnFile(t.creditCard);e.dataSource.data.push(r),e.dataSource.data=e.dataSource.data}}))},e.prototype.onDelete=function(e){var t=this;this.isDialogOpen||(this.deleteDialogRef=this.dialog.open(l.a,{data:{title:"Delete Card on File?",content:"Are you sure you want to delete this card?",noText:"No",yesText:"Yes"},panelClass:"posonline-discard-draft-dialog"}),this.deleteDialogRef.afterClosed().subscribe((function(n){return Z(t,void 0,void 0,(function(){return W(this,(function(t){switch(t.label){case 0:return t.trys.push([0,,3,4]),n?(this.cardsBeingDeleted.add(e.id),[4,this.deleteCardOnFile(e.id)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return this.cardsBeingDeleted.delete(e.id),[7];case 4:return[2]}}))}))})))},e.prototype.deleteCardOnFile=function(e){return Z(this,void 0,void 0,(function(){var t,n;return W(this,(function(i){switch(i.label){case 0:t=!1,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.cardOnFileService.delete(this.clientGuid,this.businessMerchantID,e)];case 2:return t=i.sent(),[3,4];case 3:return n=i.sent(),this.errorDialogService.openHandledErrorDialog(n.message),[3,4];case 4:return t&&(this.dataSource.data=this.dataSource.data.filter((function(t){return t.id!==e}))),[2]}}))}))},e.prototype.isCardBeingDeleted=function(e){return this.cardsBeingDeleted.has(e)},e.prototype.translateToListCardOnFile=function(e){return{id:e.id,last4Digits:e.lastDigits,expirationMonth:e.expirationMonth,expirationYear:parseInt(e.expirationYear.toString().slice(-2)),type:e.type,token:e.paymentToken}},e.\u0275fac=function(t){return new(t||e)(i.Pb(c.b),i.Pb($.a),i.Pb(H.a),i.Pb(h.a),i.Pb(p.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["card-on-file-list-paysafe"]],inputs:{clientGuid:"clientGuid",showUseCardButton:"showUseCardButton",showAddCardButton:"showAddCardButton"},outputs:{useCard:"useCard"},decls:4,vars:6,consts:[["skeletonTable","",3,"showSkeleton","skeletonTableRowAmount","placeholderHeight"],["class","empty-state","qa","no-card-on-file-text",4,"ngIf"],["class","list-container",3,"dataSource",4,"ngIf"],["mat-button","","color","primary","type","button","onclick","this.blur()","qa","add-new-card-on-file-paysafe","class","add-new-card-button",3,"click",4,"ngIf"],["qa","no-card-on-file-text",1,"empty-state"],[1,"list-container",3,"dataSource"],["matColumnDef","cardType"],[4,"matCellDef"],["matColumnDef","last4Digits"],["qa","card-on-file-list-cell-last-four",4,"matCellDef"],["matColumnDef","expireDate"],["qa","card-on-file-list-cell-exp",4,"matCellDef"],["matColumnDef","deleteAction"],["matColumnDef","useCardAction"],["class","table-row",4,"matRowDef","matRowDefColumns"],[3,"src","error"],["img",""],["class","material-icons bad-cc-image-icon",3,"inline",4,"ngIf"],[1,"material-icons","bad-cc-image-icon",3,"inline"],["qa","card-on-file-list-cell-last-four"],["qa","card-on-file-list-cell-exp"],[1,"icon-container"],["color","primary","class","material-icons btn-icon","qa","card-on-file-delete-paysafe",3,"click",4,"ngIf"],[4,"ngIf"],["color","primary","qa","card-on-file-delete-paysafe",1,"material-icons","btn-icon",3,"click"],[3,"diameter"],["mat-button","","color","primary","qa","btn-use-this-card-paysafe",1,"use-card-button",3,"click"],[1,"table-row"],["mat-button","","color","primary","type","button","onclick","this.blur()","qa","add-new-card-on-file-paysafe",1,"add-new-card-button",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Tc(1,X,2,0,"div",1),i.Tc(2,ce,12,2,"mat-table",2),i.Ub(),i.Tc(3,se,2,0,"button",3)),2&e&&(i.qc("showSkeleton",t.isLoading)("skeletonTableRowAmount",3)("placeholderHeight","30px"),i.Cb(1),i.qc("ngIf",t.dataSource&&0===t.dataSource.data.length),i.Cb(1),i.qc("ngIf",t.dataSource&&t.dataSource.data.length>0),i.Cb(1),i.qc("ngIf",t.showAddCardButton))},directives:[P.d,o.t,k.b,s.o,s.c,s.b,s.n,s.a,M.a,x.c,y.a,s.m,y.b],pipes:[o.g],styles:[".list-container[_ngcontent-%COMP%]{font-size:16px;margin:8px 0 3px;width:100%;max-height:150px;overflow-y:auto}.list-container[_ngcontent-%COMP%]   mat-row[_ngcontent-%COMP%]{border-bottom-style:none}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{flex:none;padding:0 15px 0 0}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]{padding-right:10px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:3px;height:30px;width:50px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-cardType[_ngcontent-%COMP%]   .bad-cc-image-icon[_ngcontent-%COMP%]{font-size:50px;width:50px}.list-container[_ngcontent-%COMP%]   mat-cell.mat-column-last4Digits[_ngcontent-%COMP%]{width:110px}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:0}.list-container[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     .mat-button-focus-overlay{background:none}.empty-state[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);font-size:18px;font-style:italic;margin:20px 0 13px}.add-new-card-button[_ngcontent-%COMP%]{font-size:16px}"]}),e}();function ue(e,t){if(1&e){var n=i.Wb();i.Vb(0,"card-on-file-list-card-connect",2),i.ec("useCard",(function(e){return i.Hc(n),i.ic().onUseCard(e)})),i.Ub()}if(2&e){var r=i.ic();i.qc("clientID",r.clientID)("showUseCardButton",r.showUseCardButton)("showAddCardButton",r.showAddCardButton)}}function de(e,t){if(1&e){var n=i.Wb();i.Vb(0,"card-on-file-list-paysafe",3),i.ec("useCard",(function(e){return i.Hc(n),i.ic().onUseCard(e)})),i.Ub()}if(2&e){var r=i.ic();i.qc("clientGuid",r.clientGuid)("showUseCardButton",r.showUseCardButton)("showAddCardButton",r.showAddCardButton)}}var pe=function(){function e(e){this.sessionService=e,this.useCard=new i.o}return Object.defineProperty(e.prototype,"cardProcessorEnum",{get:function(){return a.a},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.activeCardProcessor=this.sessionService.getActiveCreditCardProcessor()},e.prototype.onUseCard=function(e){this.useCard.emit(e)},e.\u0275fac=function(t){return new(t||e)(i.Pb(r.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["card-on-file-list"]],inputs:{clientID:"clientID",clientGuid:"clientGuid",showUseCardButton:"showUseCardButton",showAddCardButton:"showAddCardButton"},outputs:{useCard:"useCard"},decls:2,vars:2,consts:[[3,"clientID","showUseCardButton","showAddCardButton","useCard",4,"ngIf"],[3,"clientGuid","showUseCardButton","showAddCardButton","useCard",4,"ngIf"],[3,"clientID","showUseCardButton","showAddCardButton","useCard"],[3,"clientGuid","showUseCardButton","showAddCardButton","useCard"]],template:function(e,t){1&e&&(i.Tc(0,ue,1,3,"card-on-file-list-card-connect",0),i.Tc(1,de,1,3,"card-on-file-list-paysafe",1)),2&e&&(i.qc("ngIf",t.activeCardProcessor===t.cardProcessorEnum.CardConnect),i.Cb(1),i.qc("ngIf",t.activeCardProcessor===t.cardProcessorEnum.Paysafe))},directives:[o.t,j,le],encapsulation:2}),e}()},"16fB":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("K4Bh"),r=n("wVB6"),a=n("fXoL"),o=function(){function e(e){this.httpClient=e}return e.prototype.add=function(e,t,n,i,r,a){var o=this;return this.httpClient.post("/CardConnect/AddCardOnFile",{ClientID:e,Token:t,Zip:n,CardType:this.getCreditCardType(t),NameOnCard:i,ExpireMonth:+r,ExpireYear:+a}).then((function(e){return{accountId:e.ClientProfileAccount.AccountID,profileId:e.ClientProfileAccount.ProfileID,type:o.deserializeCreditCardType(e.ClientProfileAccount.CardType),expireMonth:e.ClientProfileAccount.ExpireMonth,expireYear:e.ClientProfileAccount.ExpireYear,clientName:e.ClientProfileAccount.NameOnCard,token:e.ClientProfileAccount.Token,zipCode:e.ClientProfileAccount.ZIP,last4Digits:e.ClientProfileAccount.Last4Digits}}))},e.prototype.delete=function(e,t){return this.httpClient.post("/CardConnect/DeleteCardOnFile",{AccountID:e,ClientID:t},{endpointVersion:"2"}).then((function(e){return!0}))},e.prototype.getList=function(e){var t=this;return this.httpClient.post("/CardConnect/GetCardOnFileList",{ClientID:e}).then((function(e){return e.ProfileAccountList.map((function(e){return{accountId:e.AccountID,profileId:e.ProfileID,type:t.deserializeCreditCardType(e.CardType),expireMonth:e.ExpireMonth,expireYear:e.ExpireYear,clientName:e.NameOnCard,token:e.Token,zipCode:e.ZIP,last4Digits:e.Token.slice(-4)}}))}))},e.prototype.deserializeCreditCardType=function(e){switch(e){case"AMEX":return r.a.AMEX;case"DISC":return r.a.DISC;case"MC":return r.a.MC;case"VISA":return r.a.VISA;case"ECHK (ACH)":return r.a.ACH;default:return r.a.UNKNOWN}},e.prototype.getCreditCardType=function(e){if(e&&e.length>=2)switch(+e[1]){case 3:return r.a.AMEX;case 4:return r.a.VISA;case 5:return r.a.MC;case 6:return r.a.DISC}return r.a.UNKNOWN},e.\u0275fac=function(t){return new(t||e)(a.ac(i.a))},e.\u0275prov=a.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"1LWA":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("ofXK"),r=n("3Pt+"),a=n("vyDZ"),o=n("fXoL"),c=function(){function e(){}return e.\u0275mod=o.Nb({type:e}),e.\u0275inj=o.Mb({factory:function(t){return new(t||e)},imports:[[i.c,r.F,a.a]]}),e}()},"5acM":function(e,t,n){"use strict";function i(e){Object.values(e.controls).forEach((function(e){e.markAsTouched(),e.controls&&i(e)}))}n.d(t,"a",(function(){return i}))},"8KOa":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("wd/R"),r=n("fXoL"),a=function(){function e(){}return e.prototype.transform=function(e,t,n){void 0===t&&(t=null);var r=null==e?void 0:e.requiredVaccinations,a=[];return(null==r?void 0:r.length)>0&&(a=r.filter((function(e){return e.petId===(null==t?void 0:t.id)&&(!(null==e?void 0:e.expirationDate)||i(e.expirationDate).isBefore(n))}))),a},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Ob({name:"expiredVaccinationForServiceOlb",type:e,pure:!0}),e}()},CNep:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("fXoL"),r=function(){function e(){this.paysafePrintCustomerReceiptRequests=new Map}return e.prototype.getCustomerReceiptRequest=function(e){return this.paysafePrintCustomerReceiptRequests.get(e)},e.prototype.removeCustomerReceiptRequest=function(e,t){this.paysafePrintCustomerReceiptRequests.has(e)&&this.paysafePrintCustomerReceiptRequests.get(e).transactionID===t&&this.paysafePrintCustomerReceiptRequests.delete(e)},e.prototype.addCustomerReceiptRequest=function(e,t){isNaN(e)||!t.customerReceiptUrl||this.paysafePrintCustomerReceiptRequests.has(e)||this.paysafePrintCustomerReceiptRequests.set(e,t)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac=function(t){return new(t||e)},providedIn:"root"}),e}()},CQps:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var i,r,a,o,c,s=n("lTCR"),l=n.n(s),u=n("YQxV"),d=n("qxfD"),p=n("XNiG"),h=n("HDdC"),f=n("wVB6"),m=n("aqCo"),b=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},g=l()(i||(i=b(["\n    subscription MySubscription($businessMerchantID: String, $transactionReferenceID: String, $transactionDateInitiated: String) {\n        transactionCompleted(\n            businessMerchantID: $businessMerchantID\n            transactionReferenceID: $transactionReferenceID\n            transactionDateInitiated: $transactionDateInitiated\n        ) {\n            accountReferenceID\n            authCode\n            baseAmount\n            businessMerchantID\n            cardNumber\n            cardType\n            expirationMonth\n            expirationYear\n            id\n            nameOnCard\n            signatureUrl\n            merchantReceipt\n            customerReceipt\n            tipAmount\n            transactionDateCompleted\n            transactionDateInitiated\n            transactionMerchantID\n            transactionReferenceID\n            transactionState\n            transactionType\n            userFriendlyFailureReason\n        }\n    }\n"],["\n    subscription MySubscription($businessMerchantID: String, $transactionReferenceID: String, $transactionDateInitiated: String) {\n        transactionCompleted(\n            businessMerchantID: $businessMerchantID\n            transactionReferenceID: $transactionReferenceID\n            transactionDateInitiated: $transactionDateInitiated\n        ) {\n            accountReferenceID\n            authCode\n            baseAmount\n            businessMerchantID\n            cardNumber\n            cardType\n            expirationMonth\n            expirationYear\n            id\n            nameOnCard\n            signatureUrl\n            merchantReceipt\n            customerReceipt\n            tipAmount\n            transactionDateCompleted\n            transactionDateInitiated\n            transactionMerchantID\n            transactionReferenceID\n            transactionState\n            transactionType\n            userFriendlyFailureReason\n        }\n    }\n"]))),v=l()(r||(r=b(["\n    subscription MySubscription($businessMerchantID: String, $transactionReferenceID: String, $transactionDateInitiated: String) {\n        transactionCompleted(\n            businessMerchantID: $businessMerchantID\n            transactionReferenceID: $transactionReferenceID\n            transactionDateInitiated: $transactionDateInitiated\n        ) {\n            accountReferenceID\n            authCode\n            baseAmount\n            businessMerchantID\n            cardNumber\n            cardType\n            expirationMonth\n            expirationYear\n            id\n            nameOnCard\n            signatureUrl\n            merchantReceipt\n            customerReceipt\n            tipAmount\n            transactionDateCompleted\n            transactionDateInitiated\n            transactionMerchantID\n            transactionReferenceID\n            transactionState\n            transactionType\n            userFriendlyFailureReason\n            singleUseCardToken\n        }\n    }\n"],["\n    subscription MySubscription($businessMerchantID: String, $transactionReferenceID: String, $transactionDateInitiated: String) {\n        transactionCompleted(\n            businessMerchantID: $businessMerchantID\n            transactionReferenceID: $transactionReferenceID\n            transactionDateInitiated: $transactionDateInitiated\n        ) {\n            accountReferenceID\n            authCode\n            baseAmount\n            businessMerchantID\n            cardNumber\n            cardType\n            expirationMonth\n            expirationYear\n            id\n            nameOnCard\n            signatureUrl\n            merchantReceipt\n            customerReceipt\n            tipAmount\n            transactionDateCompleted\n            transactionDateInitiated\n            transactionMerchantID\n            transactionReferenceID\n            transactionState\n            transactionType\n            userFriendlyFailureReason\n            singleUseCardToken\n        }\n    }\n"]))),C=n("rTmN"),y=n("IfdK"),k=n("LimZ"),x=n("Z7eK"),S=n("fXoL"),_=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},w=function(){return(w=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},P=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},M=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},O=function(){function e(e,t,n,i,r,a,o){this.appSyncService=e,this.appSyncUrlService=t,this.ngZone=n,this.checkoutService=i,this.featureService=r,this.cardOnFileService=a,this.session=o,this.paysafeTransactionUpdated$=new p.a,this.initiateTransactionFailed$=new p.a}return e.prototype.getPaysafeTransaction=function(){return this.paysafeTransaction},e.prototype.updatePaysafeTransaction=function(e){this.paysafeTransaction=new u.c(w(w({},this.paysafeTransaction),e)),this.paysafeTransactionUpdated$.next(this.paysafeTransaction)},e.prototype.paysafeTransactionUpdated=function(){return this.paysafeTransactionUpdated$.asObservable()},e.prototype.resetPaysafeTransaction=function(){this.paysafeTransaction=void 0,this.paysafeTransactionUpdated$.next(void 0)},e.prototype.completeSuccessfulTransaction=function(){this.resetPaysafeTransaction()},e.prototype.completeCanceledOrErroredTransaction=function(){this.updatePaysafeTransaction({flowType:void 0})},e.prototype.voidTransaction=function(e,t,n,i,r){return P(this,void 0,void 0,(function(){var o,c,s,u;return M(this,(function(d){switch(d.label){case 0:o=l()(a||(a=_(["\n            mutation Mutation($input: InitiateVoidTransactionInput!) {\n                initiateVoidTransaction(input: $input)\n            }\n        "],["\n            mutation Mutation($input: InitiateVoidTransactionInput!) {\n                initiateVoidTransaction(input: $input)\n            }\n        "]))),c={headers:{"device-api-key":r}},d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this.appSyncUrlService.get()];case 2:return s=d.sent(),[4,this.appSyncService.getClient(s).mutate({mutation:o,variables:{input:{businessMerchantID:e,transactionID:t,transactionMerchantID:n,transactionReferenceID:i}},context:c,errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return[2,d.sent().data.initiateVoidTransaction];case 4:if((u=d.sent()).message.includes("400")&&u.message.includes("api key"))throw new Error("Invalid device api key");throw new Error("Error occurred, please try again.");case 5:return[2]}}))}))},e.prototype.initiateManualSaleTransaction=function(e,t,n){return P(this,void 0,void 0,(function(){var i;return M(this,(function(r){switch(r.label){case 0:return i=l()(o||(o=_(["\n            mutation MyMutation($input: InitiateManualSaleTransactionInput!) {\n                initiateManualSaleTransaction(input: $input)\n            }\n        "],["\n            mutation MyMutation($input: InitiateManualSaleTransactionInput!) {\n                initiateManualSaleTransaction(input: $input)\n            }\n        "]))),[4,this.processTransaction(i,e,{businessMerchantID:e.businessMerchantID,transactionReferenceID:e.transactionReferenceID,transactionDateInitiated:e.transactionDateInitiated},t,n,!1)];case 1:return[2,r.sent()]}}))}))},e.prototype.initiateDeviceSaleTransaction=function(e,t,n,i,r){return P(this,void 0,void 0,(function(){var a,o;return M(this,(function(s){return a=l()(c||(c=_(["\n            mutation MyMutation($input: InitiateSaleTransactionInput!) {\n                initiateSaleTransaction(input: $input)\n            }\n        "],["\n            mutation MyMutation($input: InitiateSaleTransactionInput!) {\n                initiateSaleTransaction(input: $input)\n            }\n        "]))),o={headers:{"device-api-key":i.toLocaleUpperCase()}},[2,this.processTransaction(a,e,{businessMerchantID:e.businessMerchantID,transactionReferenceID:e.transactionReferenceID,transactionDateInitiated:e.transactionDateInitiated},t,n,r,o)]}))}))},e.prototype.processTransaction=function(e,t,n,i,r,a,o){return P(this,void 0,void 0,(function(){var c,s,l,d,p,f=this;return M(this,(function(m){switch(m.label){case 0:return c=this.featureService.getFeatureFlag(C.a.PaysafeCardsOnFile),[4,this.appSyncUrlService.get()];case 1:return s=m.sent(),l=this.appSyncService.getClient(s),d=c?v:g,p=new h.a((function(e){f.ngZone.runOutsideAngular((function(){return P(f,void 0,void 0,(function(){var o,s,p=this;return M(this,(function(h){return o=l.subscribe({query:d,fetchPolicy:"no-cache",variables:n}).subscribe((function(n){var o=n.data.transactionCompleted;return P(p,void 0,void 0,(function(){var n;return M(this,(function(s){switch(s.label){case 0:return"canceled"!==o.transactionState?[3,1]:(this.updatePaysafeTransaction({flowStatus:u.a.CanceledAtDevice}),[3,6]);case 1:return"failed"!==o.transactionState&&"declined"!==o.transactionState?[3,2]:(this.updatePaysafeTransaction({flowStatus:u.a.CompletedError,message:o.userFriendlyFailureReason}),[3,6]);case 2:if(n=this.createPaymentModel(o),this.checkoutService.addTenderedPayment(n),this.updatePaysafeTransaction(a?{flowStatus:u.a.Printing}:{flowStatus:u.a.CompletedSuccess}),!c||!r)return[3,6];s.label=3;case 3:return s.trys.push([3,5,,6]),[4,this.cardOnFileService.add(t.businessMerchantID,o.singleUseCardToken,this.session.customerInfo.customer_culture_code,i)];case 4:case 5:return s.sent(),[3,6];case 6:return this.ngZone.run((function(){e.next(o)})),[2]}}))}))}),(function(t){e.error(t)}),(function(){e.complete()})),s=e.add((function(){o.unsubscribe(),e.remove(s)})),[2]}))}))}))})),l.mutate({mutation:e,errorPolicy:"none",fetchPolicy:"no-cache",variables:{input:t},context:o}).catch((function(e){f.initiateTransactionFailed$.next(e)})),[2,p]}}))}))},e.prototype.createPaymentModel=function(e){var t=new f.b({name:e.nameOnCard,cardNumber:e.cardNumber,refNumber:e.id,approvalId:"Approved: "+e.authCode,tipAmount:e.tipAmount/100||0,amount:e.baseAmount/100,expirationDate:""+e.expirationMonth+e.expirationYear});return new f.e({type:f.g.Paysafe,comment:this.getPaysafeTransaction().comment,amount:(e.baseAmount+e.tipAmount)/100,creditPaymentInfo:t,customPaymentType:new f.d({paymentName:e.cardType}),tipAmount:e.tipAmount/100})},e.prototype.initiateTransactionFailed=function(){return this.initiateTransactionFailed$.asObservable()},e.\u0275fac=function(t){return new(t||e)(S.ac(d.a),S.ac(x.a),S.ac(S.B),S.ac(m.a),S.ac(C.b),S.ac(k.a),S.ac(y.a))},e.\u0275prov=S.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Kbva:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("ofXK"),r=n("3Pt+"),a=n("m/eF"),o=n("tmjD"),c=n("vyDZ"),s=n("fXoL"),l=function(){function e(){}return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[i.c,r.F,a.a,o.b.forRoot(),c.a]]}),e}()},LimZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i,r,a,o=n("qxfD"),c=n("Z7eK"),s=n("lTCR"),l=n.n(s),u=l()(i||(r=["\n    query MyQuery($businessMerchantID: ID!, $profileReferenceID: ID!) {\n        getCardOnFileList(businessMerchantID: $businessMerchantID, profileReferenceID: $profileReferenceID) {\n            id\n            lastDigits\n            expirationMonth\n            expirationYear\n            cardType\n            cardCategory\n            paymentToken\n            status\n        }\n    }\n"],a=["\n    query MyQuery($businessMerchantID: ID!, $profileReferenceID: ID!) {\n        getCardOnFileList(businessMerchantID: $businessMerchantID, profileReferenceID: $profileReferenceID) {\n            id\n            lastDigits\n            expirationMonth\n            expirationYear\n            cardType\n            cardCategory\n            paymentToken\n            status\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(r,"raw",{value:a}):r.raw=a,i=r)),d=n("pxLf");function p(e){var t;if(1===(null===(t=e.graphQLErrors)||void 0===t?void 0:t.length)){var n=e.graphQLErrors[0],i=void 0;try{i=JSON.parse(n.message)}catch(r){}if(400===(null==i?void 0:i.statusCode))return i.message}return"An error occurred, please try again."}var h,f,m=n("wVB6"),b=n("fXoL"),g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},v=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},C=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},y=function(){function e(e,t){this.appSyncUrlService=e,this.appSyncService=t}return e.prototype.add=function(e,t,n,i){return v(this,void 0,void 0,(function(){var r,a,o,c,s;return C(this,(function(u){switch(u.label){case 0:r=l()(h||(h=g(["\n            mutation Mutation($input: AddCardOnFileInput!) {\n                addCardOnFile(input: $input) {\n                    id\n                    lastDigits\n                    expirationMonth\n                    expirationYear\n                    cardType\n                    cardCategory\n                    paymentToken\n                    status\n                }\n            }\n        "],["\n            mutation Mutation($input: AddCardOnFileInput!) {\n                addCardOnFile(input: $input) {\n                    id\n                    lastDigits\n                    expirationMonth\n                    expirationYear\n                    cardType\n                    cardCategory\n                    paymentToken\n                    status\n                }\n            }\n        "]))),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.appSyncUrlService.get()];case 2:return a=u.sent(),[4,this.appSyncService.getClient(a).mutate({mutation:r,variables:{input:{businessMerchantID:e,cardToken:t,cultureCode:this.toPaysafeCultureCode(n),profileReferenceID:i}},errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return o=u.sent(),[2,this.convertBackendToFrontEnd(o.data.addCardOnFile)];case 4:throw c=u.sent(),s=p(c),new Error(s);case 5:return[2]}}))}))},e.prototype.getList=function(e,t){return v(this,void 0,void 0,(function(){var n,i,r,a=this;return C(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,this.appSyncUrlService.get()];case 1:return n=o.sent(),[4,this.appSyncService.getClient(n).query({query:u,variables:{businessMerchantID:e,profileReferenceID:t},errorPolicy:"none",fetchPolicy:"no-cache"})];case 2:return[2,o.sent().data.getCardOnFileList.map((function(e){return a.convertBackendToFrontEnd(e)}))];case 3:if(i=o.sent(),"Profile was not found."===(r=p(i)))return[2,[]];throw new Error(r);case 4:return[2]}}))}))},e.prototype.delete=function(e,t,n){return v(this,void 0,void 0,(function(){var i,r,a,o;return C(this,(function(c){switch(c.label){case 0:i=l()(f||(f=g(["\n            mutation Mutation($input: DeleteCardOnFileInput!) {\n                deleteCardOnFile(input: $input)\n            }\n        "],["\n            mutation Mutation($input: DeleteCardOnFileInput!) {\n                deleteCardOnFile(input: $input)\n            }\n        "]))),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.appSyncUrlService.get()];case 2:return r=c.sent(),[4,this.appSyncService.getClient(r).mutate({mutation:i,variables:{input:{profileReferenceID:e,businessMerchantID:t,cardID:n}},errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return[2,c.sent().data.deleteCardOnFile];case 4:throw a=c.sent(),o=p(a),new Error(o);case 5:return[2]}}))}))},e.prototype.toPaysafeCultureCode=function(e){return e===d.a.US?"en_US":e===d.a.Canada?"fr_CA":"en_US"},e.prototype.mapToCardType=function(e){return"AM"===e?m.a.AMEX:"DI"===e?m.a.DISC:"MC"===e?m.a.MC:"VI"===e?m.a.VISA:m.a.UNKNOWN},e.prototype.convertBackendToFrontEnd=function(e){return{id:e.id,lastDigits:e.lastDigits,expirationMonth:e.expirationMonth,expirationYear:e.expirationYear,type:this.mapToCardType(e.cardType),paymentToken:e.paymentToken,category:e.cardCategory,status:e.status}},e.\u0275fac=function(t){return new(t||e)(b.ac(c.a),b.ac(o.a))},e.\u0275prov=b.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"Q+Ow":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("wd/R"),r=n("fXoL"),a=function(){function e(){}return e.prototype.transform=function(e,t,n){return void 0===t&&(t=null),e.filter((function(e){var n;return(null===(n=e.pet)||void 0===n?void 0:n.id)===(null==t?void 0:t.id)&&e.requiredVaccinations})).map((function(e){return e.requiredVaccinations})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return!(null==e?void 0:e.id)||!e.expirationDate||i(e.expirationDate).isBefore(n)}))},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Ob({name:"expiredVaccinationForService",type:e,pure:!0}),e}()},RQB8:function(e,t,n){e.exports=n("ls82")},VayK:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("fXoL"),r=n("wd/R"),a=n("ofXK");function o(e,t){if(1&e){var n=i.Wb();i.Vb(0,"div",1),i.Vb(1,"i",2),i.Vc(2,"report_problem"),i.Ub(),i.Vb(3,"div",3),i.Vc(4),i.Vb(5,"button",4),i.ec("click",(function(){return i.Hc(n),i.ic().actionTaken()})),i.Vc(6,"Update"),i.Ub(),i.Ub(),i.Ub()}if(2&e){var r=i.ic();i.Cb(4),i.Xc(" ",r.warningText," ")}}var c=function(){function e(){this.updateAction=new i.o,this.expiredVaccinations=[]}return e.prototype.ngOnInit=function(){var e=this;this.expiredVaccinations=this.requiredVaccinations.filter((function(t){return!t.id||!t.expirationDate||r(t.expirationDate).isBefore(e.appointmentDate)}))},e.prototype.ngOnChanges=function(){var e=this;this.expiredVaccinations=this.requiredVaccinations.filter((function(t){return!t.id||!t.expirationDate||r(t.expirationDate).isBefore(e.appointmentDate)}))},Object.defineProperty(e.prototype,"warningText",{get:function(){return this.generateWarningText(this.expiredVaccinations)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vaccinationsAreExpiredOrMissing",{get:function(){return this.expiredVaccinations.length>0},enumerable:!1,configurable:!0}),e.prototype.actionTaken=function(){this.updateAction.emit()},e.prototype.generateWarningText=function(e){switch(e.length){case 0:return"";case 1:return e[0].name+" is required.";case 2:return e.map((function(e){return e.name})).join(" and ")+" are required.";default:return e.slice(0,e.length-1).map((function(e){return e.name})).join(", ")+", and "+e[e.length-1].name+" are required."}},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-vaccination-alert"]],inputs:{requiredVaccinations:"requiredVaccinations",appointmentDate:"appointmentDate"},outputs:{updateAction:"updateAction"},features:[i.Ab],decls:1,vars:1,consts:[["class","vaccination-alert",4,"ngIf"],[1,"vaccination-alert"],[1,"material-icons"],[1,"vaccination-alert-text"],[1,"vaccination-action-button",3,"click"]],template:function(e,t){1&e&&i.Tc(0,o,7,1,"div",0),2&e&&i.qc("ngIf",t.expiredVaccinations.length)},directives:[a.t],styles:["[_nghost-%COMP%]{align-self:stretch}.vaccination-alert[_ngcontent-%COMP%]{display:flex;font-style:normal;align-items:center;align-self:stretch;margin:3px 0;padding:5px 0;width:100%;font-size:12px;background-color:rgba(176,0,32,.05)}.vaccination-alert.vaccination-warning[_ngcontent-%COMP%]{background-color:rgba(229,160,29,.1)}.vaccination-alert.vaccination-warning[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#e5a01d}.vaccination-alert[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b00020;margin-left:8px;margin-right:4px;font-size:20px}.vaccination-alert[_ngcontent-%COMP%]   i.expired-soon[_ngcontent-%COMP%]{color:#e5a01d}.vaccination-alert[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;display:inline-block;margin-left:14px;font-weight:700;background:transparent;color:#b00020}"]}),e}()},YQxV:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a}));var i=function(e){return e[e.Manual=0]="Manual",e[e.Device=1]="Device",e[e.OnFileDevice=2]="OnFileDevice",e[e.OnFile=3]="OnFile",e}({}),r=function(e){return e[e.Initializing=0]="Initializing",e[e.ProcessingManual=1]="ProcessingManual",e[e.ProcessingDevice=2]="ProcessingDevice",e[e.ProccessingSavedCard=3]="ProccessingSavedCard",e[e.Polling=4]="Polling",e[e.ReadingLog=5]="ReadingLog",e[e.DistributingTips=6]="DistributingTips",e[e.Completing=7]="Completing",e[e.CompletedSuccess=8]="CompletedSuccess",e[e.CompletedError=9]="CompletedError",e[e.CanceledInBrowser=10]="CanceledInBrowser",e[e.CanceledAtDevice=11]="CanceledAtDevice",e[e.Cancelling=12]="Cancelling",e[e.Printing=13]="Printing",e}({}),a=function(){return function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];this[i]=e[i]}}}()},Z7eK:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i,r=n("lTCR"),a=n.n(r),o=n("qgav"),c=n("qxfD"),s=n("PnPc"),l=n("fXoL"),u=function(){function e(e,t,n){this.envConfigLoader=e,this.authTokensService=t,this.appSyncService=n}return e.prototype.get=function(){var e,t,n,r;return t=this,void 0,r=function(){var t,n,r,o,c;return function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(s){switch(s.label){case 0:return(null===(e=this.cachedAppSyncUrl)||void 0===e?void 0:e.length)?[3,3]:[4,this.authTokensService.getIdToken(!1).toPromise()];case 1:return t=s.sent(),n=this.envConfigLoader.getEnvConfig().paysafeServiceUrl,r={headers:{"Content-Type":"application/json",Authorization:t}},o=a()(i||(l=["\n                query getAppSyncUrl {\n                    getAppSyncUrl\n                }\n            "],u=["\n                query getAppSyncUrl {\n                    getAppSyncUrl\n                }\n            "],Object.defineProperty?Object.defineProperty(l,"raw",{value:u}):l.raw=u,i=l)),[4,this.appSyncService.getClient(n).query({query:o,context:r,errorPolicy:"none",fetchPolicy:"no-cache"})];case 2:c=s.sent(),this.cachedAppSyncUrl=c.data.getAppSyncUrl,s.label=3;case 3:return[2,this.cachedAppSyncUrl]}var l,u}))},new((n=void 0)||(n=Promise))((function(e,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function o(e){try{c(r.throw(e))}catch(t){i(t)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(a,o)}c((r=r.apply(t,[])).next())}))},e.\u0275fac=function(t){return new(t||e)(l.ac(s.a),l.ac(o.a),l.ac(c.a))},e.\u0275prov=l.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},a31p:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i,r=n("0IaG"),a=n("zi3Y"),o=n("0Yud"),c=n("brfy"),s=n("IfdK"),l=n("CQps"),u=n("pE+g"),d=n("rTmN"),p=n("CNep"),h=n("fXoL"),f=n("ofXK"),m=n("qFsG"),b=n("3Pt+"),g=n("ccMj"),v=n("bSwM"),C=n("bTqV"),y=n("Xa2L"),k=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),x=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},S=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function _(e,t){if(1&e&&h.Qb(0,"p",11),2&e){var n=h.ic();h.qc("innerHTML",n.data.emphasizedContent,h.Ic)}}function w(e,t){if(1&e){var n=h.Wb();h.Vb(0,"div",12),h.Vb(1,"mat-checkbox",13),h.ec("ngModelChange",(function(e){return h.Hc(n),h.ic().shouldVoidTransactions=e})),h.Vc(2,"Void credit card transactions"),h.Ub(),h.Qb(3,"br"),h.Ub()}if(2&e){var i=h.ic();h.Cb(1),h.qc("ngModel",i.shouldVoidTransactions)("checked",i.shouldVoidTransactions)}}function P(e,t){if(1&e){var n=h.Wb();h.Vb(0,"button",14),h.ec("click",(function(){return h.Hc(n),h.ic().onNoClick()})),h.Ub()}if(2&e){var i=h.ic();h.qc("disabled",i.showActionWheel)("innerHTML",i.data.noText,h.Ic)}}function M(e,t){if(1&e&&(h.Tb(0),h.Vc(1),h.Sb()),2&e){var n=h.ic(2);h.Cb(1),h.Wc(n.data.yesText)}}function O(e,t){1&e&&(h.Vb(0,"div",18),h.Qb(1,"mat-spinner",19),h.Ub()),2&e&&(h.Cb(1),h.qc("diameter",23))}function V(e,t){if(1&e){var n=h.Wb();h.Vb(0,"button",15),h.ec("click",(function(){return h.Hc(n),h.ic().onActionClick()})),h.Tc(1,M,2,1,"ng-container",16),h.Tc(2,O,2,1,"div",17),h.Ub()}if(2&e){var i=h.ic();h.Cb(1),h.qc("ngIf",!i.yesFnComplete&&!i.showActionWheel),h.Cb(1),h.qc("ngIf",i.showActionWheel&&!i.yesFnComplete)}}function I(e,t){if(1&e){var n=h.Wb();h.Vb(0,"div",20),h.Vb(1,"button",21),h.ec("click",(function(){return h.Hc(n),h.ic().closeNow()})),h.Vc(2,"Close"),h.Ub(),h.Vc(3),h.Ub()}if(2&e){var i=h.ic();h.Cb(3),h.Xc(" in: ",i.finishedCountdown?"("+i.finishedCountdown+")":""," ")}}var D=function(e){function t(t,n,i,r,a,o,c,s){var l=e.call(this,t,s)||this;return l.dialogRef=t,l.ticketService=n,l.sessionService=i,l.paysafeService=r,l.paysafeSettingsService=a,l.paysafeDevicePrintReceiptService=o,l.featureService=c,l.data=s,l.shouldVoidTransactionsFromUserSelection=!1,l}return k(t,e),t.prototype.ngOnInit=function(){this.dialogRef.updateSize("460px"),this.shouldVoidTransactionsFromUserSelection=this.data.voidTransactionsFromUserSelection,this.shouldVoidTransactionsFromUserSelection&&(this.shouldVoidTransactions=!0),this.isPaysafe=this.sessionService.getActiveCreditCardProcessor()===c.a.Paysafe&&this.featureService.getFeatureFlag(d.a.PaysafeCreditCardProcessing)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t.prototype.onActionClick=function(){return x(this,void 0,void 0,(function(){return S(this,(function(e){switch(e.label){case 0:if(this.showActionWheel)return this.apiCallSuccess=!0,[2];this.dialogRef.disableClose=!0,this.showActionWheel=!0,e.label=1;case 1:return e.trys.push([1,11,12,13]),this.data.voidSelected?this.isPaysafe?this.shouldVoidTransactions?[4,this.voidPaysafeTransactions()]:[3,3]:[3,5]:[3,8];case 2:e.sent(),e.label=3;case 3:return[4,this.ticketService.voidSelectedAppts(this.data.ticketList,this.data.voidComment,!1)];case 4:return e.sent(),[3,7];case 5:return[4,this.ticketService.voidSelectedAppts(this.data.ticketList,this.data.voidComment,this.shouldVoidTransactions)];case 6:e.sent(),e.label=7;case 7:return[3,10];case 8:return[4,this.ticketService.voidAllForClient(this.data.clientId,this.data.ticketStatus,this.data.voidComment,this.data.onlyForUpcomingAppts,this.shouldVoidTransactions)];case 9:e.sent(),e.label=10;case 10:return[3,13];case 11:return e.sent(),this.dialogRef.removePanelClass("posonline-discard-draft-dialog").addPanelClass("posonline-error-state-dialog"),this.data.errorState=!0,this.data.title=this.data.failTitle,this.data.content=this.data.failContent,this.apiCallSuccess=!1,[3,13];case 12:return this.yesFnComplete=this.hideNoBtn=this.hideYesBtn=!0,this.closeNow(),[7];case 13:return[2]}}))}))},t.prototype.voidPaysafeTransactions=function(){return x(this,void 0,void 0,(function(){var e,t,n,i,r,a,o,c=this;return S(this,(function(s){switch(s.label){case 0:return[4,this.paysafeSettingsService.getSettings().toPromise()];case 1:e=s.sent(),t=e.paysafeSettings.paysafeMerchantID,n=e.paysafeSettings.paysafeMerchantID,i=e.paysafeSettings.paysafeDeviceApiKey,r=function(e){var r,a,o,s;return S(this,(function(l){switch(l.label){case 0:for(r=[],a=function(a){a.amount>0&&"Cash"!==a.customPaymentType.paymentName&&r.push((function(){c.paysafeService.voidTransaction(t,a.creditPaymentInfo.refNumber,n,e.id,i),c.paysafeDevicePrintReceiptService.removeCustomerReceiptRequest(e.id,a.creditPaymentInfo.refNumber)}))},o=0,s=e.payments;o<s.length;o++)a(s[o]);return[4,Promise.all(r)];case 1:return l.sent(),[2]}}))},a=0,o=this.data.ticketList,s.label=2;case 2:return a<o.length?[5,r(o[a])]:[3,5];case 3:s.sent(),s.label=4;case 4:return a++,[3,2];case 5:return[2]}}))}))},t.\u0275fac=function(e){return new(e||t)(h.Pb(r.i),h.Pb(o.a),h.Pb(s.a),h.Pb(l.a),h.Pb(u.a),h.Pb(p.a),h.Pb(d.b),h.Pb(r.a))},t.\u0275cmp=h.Jb({type:t,selectors:[["ticket-void-dialog-component"]],features:[h.zb],decls:11,vars:8,consts:[["mat-dialog-title","",3,"innerHTML"],["mat-dialog-content",""],["class","emphasize",3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"void-comment"],["qa","textbox-comment","matInput","","name","note","placeholder","Reason for void?",3,"ngModel","ngModelChange"],["class","void-transaction-container",4,"ngIf"],["mat-dialog-actions",""],["class","no-btn","qa","dialog-no-btn","mat-raised-button","",3,"disabled","innerHTML","click",4,"ngIf"],["class","yes-btn gen-dialog-action-spinner","qa","dialog-ok-btn","mat-raised-button","","color","primary","cdkFocusInitial","",3,"click",4,"ngIf"],["class","close-countdown","qa","close-countdown",4,"ngIf"],[1,"emphasize",3,"innerHTML"],[1,"void-transaction-container"],["qa","void-cc-checkbox",3,"ngModel","checked","ngModelChange"],["qa","dialog-no-btn","mat-raised-button","",1,"no-btn",3,"disabled","innerHTML","click"],["qa","dialog-ok-btn","mat-raised-button","","color","primary","cdkFocusInitial","",1,"yes-btn","gen-dialog-action-spinner",3,"click"],[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"spinner"],[3,"diameter"],["qa","close-countdown",1,"close-countdown"],[3,"click"]],template:function(e,t){1&e&&(h.Qb(0,"h1",0),h.Vb(1,"div",1),h.Tc(2,_,1,1,"p",2),h.Qb(3,"p",3),h.Ub(),h.Vb(4,"div",4),h.Vb(5,"textarea",5),h.ec("ngModelChange",(function(e){return t.data.voidComment=e})),h.Ub(),h.Ub(),h.Tc(6,w,4,2,"div",6),h.Vb(7,"div",7),h.Tc(8,P,1,2,"button",8),h.Tc(9,V,3,2,"button",9),h.Tc(10,I,4,1,"div",10),h.Ub()),2&e&&(h.qc("innerHTML",t.data.title,h.Ic),h.Cb(2),h.qc("ngIf",t.data&&t.data.emphasizedContent),h.Cb(1),h.qc("innerHTML",t.data.content?t.data.content:"",h.Ic),h.Cb(2),h.qc("ngModel",t.data.voidComment),h.Cb(1),h.qc("ngIf",!t.yesFnComplete),h.Cb(2),h.qc("ngIf",!t.hideNoBtn),h.Cb(1),h.qc("ngIf",!t.hideYesBtn),h.Cb(1),h.qc("ngIf",t.yesFnComplete))},directives:[r.j,r.g,f.t,m.b,b.d,g.b,b.v,b.y,r.c,v.a,C.b,y.c],styles:[".void-comment[_ngcontent-%COMP%]{margin:2px 10px 10px 5px;padding:5px;border:.5px solid #707070}.void-comment[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:78px;width:100%;resize:none;border:0}",".mat-dialog-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.mat-dialog-actions[_ngcontent-%COMP%]{width:calc(100% + 48px);margin-left:-24px;display:flex;float:none;justify-content:flex-end;border-top:1px solid #b2b2b2;padding:0}.mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:32px;font-size:14px}.mat-dialog-actions[_ngcontent-%COMP%]   .no-btn[_ngcontent-%COMP%]{color:#656565;border:1px solid #656565;line-height:0;display:inline-block;text-align:center;width:auto}.mat-dialog-actions[_ngcontent-%COMP%]   .yes-btn[_ngcontent-%COMP%]{width:auto!important;margin-left:0!important;padding:0 25px}.emphasize[_ngcontent-%COMP%]{font-weight:600}.close-countdown[_ngcontent-%COMP%]{height:30px;font-size:15px;color:#656565;margin-right:24px}.close-countdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:30px;margin:0;width:42px;font-size:15px;border:0;font-weight:700;text-decoration:underline;cursor:pointer}.error-state-countdown[_ngcontent-%COMP%]{color:#fff}.error-state-countdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent}.gen-dialog-action-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.void-transaction-container[_ngcontent-%COMP%]{margin:0 0 15px 10px}.void-transaction-container[_ngcontent-%COMP%]     .mat-checkbox-label{font-size:16px!important}"]}),t}(a.a)},fCrE:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var i=n("fXoL"),r=n("3Pt+"),a=n("PnPc"),o=n("wd/R"),c=n("XNiG"),s=n("xgIS"),l=n("1G5W"),u=n("jhN1"),d=n("ccMj"),p=n("ofXK"),h=n("tmjD"),f=n("3fQp");function m(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Name is required"),i.Ub())}function b(e,t){if(1&e&&(i.Tb(0),i.Tc(1,m,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.nameOnCard.errors?null:n.nameOnCard.errors.required)}}function g(e,t){1&e&&i.Qb(0,"input",12)}function v(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid card number"),i.Ub())}function C(e,t){if(1&e&&(i.Tb(0),i.Tc(1,v,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.cardToken||null==n.cardToken.errors?null:n.cardToken.errors.invalidCreditCardNum)}}function y(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Expiration is required"),i.Ub())}function k(e,t){1&e&&i.Vc(0,"Invalid expiration date")}function x(e,t){if(1&e&&(i.Tb(0),i.Tc(1,y,2,0,"div",13),i.Tc(2,k,1,0,"ng-template",null,14,i.Uc),i.Sb()),2&e){var n=i.Dc(3),r=i.ic();i.Cb(1),i.qc("ngIf",null==r.cardExpiration.errors?null:r.cardExpiration.errors.required)("ngIfElse",n)}}function S(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Security code is required"),i.Ub())}function _(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid security code"),i.Ub())}function w(e,t){if(1&e&&(i.Tb(0),i.Tc(1,S,2,0,"div",3),i.Tc(2,_,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.creditCardCVV||null==n.creditCardCVV.errors?null:n.creditCardCVV.errors.required),i.Cb(1),i.qc("ngIf",!(null!=n.creditCardCVV&&null!=n.creditCardCVV.errors&&n.creditCardCVV.errors.required))}}function P(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Zip code is required"),i.Ub())}function M(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid zip code"),i.Ub())}function O(e,t){if(1&e&&(i.Tb(0),i.Tc(1,P,2,0,"div",3),i.Tc(2,M,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.zipCode||null==n.zipCode.errors?null:n.zipCode.errors.required),i.Cb(1),i.qc("ngIf",!(null!=n.zipCode&&null!=n.zipCode.errors&&n.zipCode.errors.required))}}var V=function(){function e(e,t,n,r){this.envConfigLoader=e,this.fb=t,this.formDirective=n,this.sanitizer=r,this.tokenizerInitialized=new i.o,this.isLoadingCardNumberIframe=!0,this.ngUnsubscribe=new c.a}return Object.defineProperty(e.prototype,"nameOnCard",{get:function(){return this.tokenizationFormFieldGroup.get("nameOnCard")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cardToken",{get:function(){return this.tokenizationFormFieldGroup.get("cardToken")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cardExpiration",{get:function(){return this.tokenizationFormFieldGroup.get("cardExpiration")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardCVV",{get:function(){return this.tokenizationFormFieldGroup.get("creditCardCVV")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zipCode",{get:function(){return this.tokenizationFormFieldGroup.get("zipCode")},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.tokenizationFormFieldGroup=this.fb.group({nameOnCard:["",[r.J.required]],cardToken:["",[r.J.required]],cardExpiration:["",[r.J.required,r.J.minLength(4),r.J.maxLength(4),this.creditCardExpirationValidator()]],creditCardCVV:["",[r.J.required,r.J.minLength(3),r.J.maxLength(4)]],zipCode:["",[r.J.required,r.J.minLength(5)]]}),this.formDirective.form.addControl(this.tokenizationFormGroupName,this.tokenizationFormFieldGroup);var t=this.envConfigLoader.getEnvConfig().env;this.creditCardTokenizerUrl=this.sanitizer.bypassSecurityTrustResourceUrl(encodeURI("https://daysmart.cardconnect.com:"+("prod"===t||"accept"===t?"8443":"6443")+"/itoke/ajax-tokenizer.html"+this.generateCSSAsURLParams()+"&invalidinputevent=true&tokenizewheninactive=true&formatinput=true")),Object(s.a)(window,"message").pipe(Object(l.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.origin.indexOf("daysmart.cardconnect.com")>=0){var n=t.data;if(n){var i=void 0;try{i=JSON.parse(n)}catch(r){return}e.setCardTokenFromIframe(i.message)}}})),this.formDirective.ngSubmit.subscribe((function(){e.cardToken.value||e.cardToken.setErrors({invalidCreditCardNum:!0})}))},e.prototype.setCardTokenFromIframe=function(e){e?(this.cardToken.setValue(e),this.cardToken.setErrors(null)):this.cardToken.setErrors({invalidCreditCardNum:!0}),this.cardToken.markAsTouched()},e.prototype.cardNumberIframeLoaded=function(){this.isLoadingCardNumberIframe=!1,this.tokenizerInitialized.emit()},e.prototype.generateCSSAsURLParams=function(){return"?css=body{margin: 0;}input{box-sizing: border-box;outline: none;width: 300px;font-size: 16px;height:36px; padding: 8px 10px;border: 1px solid rgb(101,101,101);border-radius: 5px;}"},e.prototype.creditCardExpirationValidator=function(){return function(e){var t,n=e.value,i=null!==(t=null==n?void 0:n.match(/.{2}/g))&&void 0!==t?t:[0,0],r=i[0],a=i[1],c=o(a+"-"+r,"YY-MM").isValid(),s=o(a+"-"+r,"YY-MM").add(1,"month").isAfter(o());return c&&s?null:{invalidExpiration:!0}}},e.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},e.\u0275fac=function(t){return new(t||e)(i.Pb(a.a),i.Pb(r.h),i.Pb(r.m),i.Pb(u.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["card-connect-tokenization-form-fields"]],inputs:{tokenizationFormGroupName:"tokenizationFormGroupName"},outputs:{tokenizerInitialized:"tokenizerInitialized"},features:[i.Bb([],[{provide:r.c,useExisting:r.m}])],decls:33,vars:16,consts:[[1,"input-container"],["mat-input","","qa","cc-name","type","text","maxlength","60",3,"formControl"],[1,"input-error"],[4,"ngIf"],[1,"input-container","card-number-container"],["type","hidden",3,"formControl"],["qa","cc-number","id","tokenFrame","name","tokenFrame","frameborder","0","scrolling","no",3,"src","load"],["mat-input","","readonly","",4,"ngIf"],[1,"credit-card-expiration-input"],["mat-input","","qa","cc-exp","type","text","maxlength","5","placeholder","MM/YY","mask","00/00",3,"formControl"],["mat-input","","qa","cc-cvv","onlyNumber","","type","text","maxlength","4","placeholder","CVV",3,"formControl"],["mat-input","","qa","cc-zip","onlyNumber","","type","text","maxlength","5",3,"formControl"],["mat-input","","readonly",""],[4,"ngIf","ngIfElse"],["invalidExpiration",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"label"),i.Vc(2,"Name on Card"),i.Ub(),i.Qb(3,"input",1),i.Vb(4,"div",2),i.Tc(5,b,2,1,"ng-container",3),i.Ub(),i.Ub(),i.Vb(6,"div",4),i.Vb(7,"label"),i.Vc(8,"Card Number"),i.Ub(),i.Qb(9,"input",5),i.Vb(10,"iframe",6),i.ec("load",(function(){return t.cardNumberIframeLoaded()})),i.Ub(),i.Tc(11,g,1,0,"input",7),i.Vb(12,"div",2),i.Tc(13,C,2,1,"ng-container",3),i.Ub(),i.Ub(),i.Vb(14,"div",0),i.Vb(15,"label"),i.Vc(16,"Expiration"),i.Ub(),i.Vb(17,"div",8),i.Qb(18,"input",9),i.Ub(),i.Vb(19,"div",2),i.Tc(20,x,4,2,"ng-container",3),i.Ub(),i.Ub(),i.Vb(21,"div",0),i.Vb(22,"label"),i.Vc(23,"Security Code"),i.Ub(),i.Qb(24,"input",10),i.Vb(25,"div",2),i.Tc(26,w,3,2,"ng-container",3),i.Ub(),i.Ub(),i.Vb(27,"div",0),i.Vb(28,"label"),i.Vc(29,"Zip Code"),i.Ub(),i.Qb(30,"input",11),i.Vb(31,"div",2),i.Tc(32,O,3,2,"ng-container",3),i.Ub(),i.Ub()),2&e&&(i.Cb(3),i.qc("formControl",t.nameOnCard),i.Cb(2),i.qc("ngIf",t.nameOnCard.touched&&t.nameOnCard.invalid),i.Cb(4),i.qc("formControl",t.cardToken),i.Cb(1),i.Qc("visibility",t.isLoadingCardNumberIframe?"hidden":"visible")("height",t.isLoadingCardNumberIframe?0:null),i.qc("src",t.creditCardTokenizerUrl,i.Jc),i.Cb(1),i.qc("ngIf",t.isLoadingCardNumberIframe),i.Cb(2),i.qc("ngIf",t.cardToken.touched&&t.cardToken.invalid),i.Cb(5),i.qc("formControl",t.cardExpiration),i.Cb(2),i.qc("ngIf",t.cardExpiration.touched&&t.cardExpiration.invalid),i.Cb(4),i.qc("formControl",t.creditCardCVV),i.Cb(2),i.qc("ngIf",t.creditCardCVV.touched&&t.creditCardCVV.invalid),i.Cb(4),i.qc("formControl",t.zipCode),i.Cb(2),i.qc("ngIf",t.zipCode.touched&&t.zipCode.invalid))},directives:[r.d,d.b,r.p,r.v,r.j,p.t,h.a,f.b],styles:["[_nghost-%COMP%]{display:contents}.input-container[_ngcontent-%COMP%]{flex:1 1 0;min-width:150px}.input-container.card-number-container[_ngcontent-%COMP%]{max-width:300px;min-width:300px}.input-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#656565;font-size:14px;margin-bottom:3px}.input-container[_ngcontent-%COMP%]   .dynamic-input[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:36px;width:100%;border-radius:5px;border-width:1px;padding:8px 10px}.input-container[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:#e74c3c;font-size:12px;height:18px}iframe[_ngcontent-%COMP%]{display:block;height:36px;width:100%}"]}),e}()},gzIF:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n("fXoL"),r=n("3Pt+"),a=n("PnPc"),o=n("ccMj"),c=n("ofXK");function s(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Name is required"),i.Ub())}function l(e,t){if(1&e&&(i.Tb(0),i.Tc(1,s,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.nameOnCard.errors?null:n.nameOnCard.errors.required)}}function u(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Card number is required"),i.Ub())}function d(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid card number"),i.Ub())}function p(e,t){if(1&e&&(i.Tb(0),i.Tc(1,u,2,0,"div",3),i.Tc(2,d,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.creditCardNumber.errors?null:n.creditCardNumber.errors.required),i.Cb(1),i.qc("ngIf",null==n.creditCardNumber.errors?null:n.creditCardNumber.errors.invalid)}}function h(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Expiration is required"),i.Ub())}function f(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid expiration date"),i.Ub())}function m(e,t){if(1&e&&(i.Tb(0),i.Tc(1,h,2,0,"div",3),i.Tc(2,f,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.creditCardExpiration.errors?null:n.creditCardExpiration.errors.required),i.Cb(1),i.qc("ngIf",null==n.creditCardExpiration.errors?null:n.creditCardExpiration.errors.invalid)}}function b(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Security code is required"),i.Ub())}function g(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid security code"),i.Ub())}function v(e,t){if(1&e&&(i.Tb(0),i.Tc(1,b,2,0,"div",3),i.Tc(2,g,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.creditCardCVV.errors?null:n.creditCardCVV.errors.required),i.Cb(1),i.qc("ngIf",null==n.creditCardCVV.errors?null:n.creditCardCVV.errors.invalid)}}function C(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Postal code is required"),i.Ub())}function y(e,t){1&e&&(i.Vb(0,"div"),i.Vc(1,"Invalid postal code"),i.Ub())}function k(e,t){if(1&e&&(i.Tb(0),i.Tc(1,C,2,0,"div",3),i.Tc(2,y,2,0,"div",3),i.Sb()),2&e){var n=i.ic();i.Cb(1),i.qc("ngIf",null==n.zipCode.errors?null:n.zipCode.errors.required),i.Cb(1),i.qc("ngIf",null==n.zipCode.errors?null:n.zipCode.errors.minlength)}}var x=function(){function e(e,t,n){this.envConfigLoader=e,this.fb=t,this.formDirective=n,this.tokenizerInitialized=new i.o,this.cardTokenized=new i.o,this.cardTokenizationFailed=new i.o;var r=this.envConfigLoader.getEnvConfig().paysafeApiKey,a={environment:this.envConfigLoader.getEnvConfig().paysafeEnv,fields:{cardNumber:{selector:"#cardNumber"},expiryDate:{selector:"#expiryDate",placeholder:"MM/YY"},cvv:{selector:"#cvv"}}};this.loadPaysafeJS(r,a)}return Object.defineProperty(e.prototype,"nameOnCard",{get:function(){return this.tokenizationFormFieldGroup.get("nameOnCard")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardNumber",{get:function(){return this.tokenizationFormFieldGroup.get("cardNumber")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardExpiration",{get:function(){return this.tokenizationFormFieldGroup.get("cardExpiration")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditCardCVV",{get:function(){return this.tokenizationFormFieldGroup.get("creditCardCVV")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zipCode",{get:function(){return this.tokenizationFormFieldGroup.get("zipCode")},enumerable:!1,configurable:!0}),e.prototype.loadPaysafeJS=function(e,t){var n=this,i=document.createElement("script");i.innerHTML="",i.src="https://hosted.paysafe.com/js/v1/latest/paysafe.min.js",i.async=!1,i.defer=!0,i.addEventListener("load",(function(){n.initializePaysafe(e,t),document.head.removeChild(i)})),document.head.appendChild(i)},e.prototype.initializePaysafe=function(e,t){var n=this;window.paysafe.fields.setup(e,t,(function(e,t){n.paysafeSetupCallback(e,t)}))},e.prototype.paysafeSetupCallback=function(e,t){var n,i=this;e?(this.paysafeJsInstance=e,e.fields("cardNumber").on("Valid",(function(){i.creditCardNumber.setErrors(null)})),e.fields("cardNumber").on("Blur",(function(e){var t=e.fields("cardNumber");t.isEmpty()?i.creditCardNumber.setErrors({required:!0}):t.isValid()?i.creditCardNumber.setErrors(null):i.creditCardNumber.setErrors({invalid:!0}),i.creditCardNumber.markAsTouched()})),e.fields("expiryDate").on("Valid",(function(){i.creditCardExpiration.setErrors(null)})),e.fields("expiryDate").on("Blur",(function(e){var t=e.fields("expiryDate");t.isEmpty()?i.creditCardExpiration.setErrors({required:!0}):t.isValid()?i.creditCardExpiration.setErrors(null):i.creditCardExpiration.setErrors({invalid:!0}),i.creditCardExpiration.markAsTouched()})),e.fields("cvv").on("Valid",(function(){i.creditCardCVV.setErrors(null)})),e.fields("cvv").on("Blur",(function(e){var t=e.fields("cvv");t.isEmpty()?i.creditCardCVV.setErrors({required:!0}):t.isValid()?i.creditCardCVV.setErrors(null):i.creditCardCVV.setErrors({invalid:!0}),i.creditCardCVV.markAsTouched()})),this.tokenizerInitialized.emit()):(null===(n=null==t?void 0:t.displayMessage)||void 0===n?void 0:n.length)>0?this.cardTokenizationFailed.emit(t.displayMessage):this.cardTokenizationFailed.emit("Something went wrong, please try again.")},e.prototype.ngOnInit=function(){var e=this;this.tokenizationFormFieldGroup=this.fb.group({nameOnCard:["",[r.J.required]],cardNumber:["",[r.J.required]],cardExpiration:["",[r.J.required,r.J.minLength(5)]],creditCardCVV:["",[r.J.required,r.J.minLength(3)]],zipCode:["",[r.J.required,r.J.minLength(5)]]}),this.formDirective.form.addControl(this.tokenizationFormGroupName,this.tokenizationFormFieldGroup),this.formDirective.ngSubmit.subscribe((function(){e.paysafeJsInstance.tokenize({},(function(t,n,i){return r=e,void 0,o=function(){return function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(e){return n&&n.fieldErrors?(t.fields("cardNumber").isEmpty()&&this.creditCardNumber.setErrors({required:!0}),t.fields("expiryDate").isEmpty()&&this.creditCardExpiration.setErrors({required:!0}),t.fields("cvv").isEmpty()&&this.creditCardCVV.setErrors({required:!0})):this.formDirective.valid&&this.cardTokenized.emit(i.token),this.tokenizationFormFieldGroup.markAllAsTouched(),[2]}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{c(o.next(e))}catch(n){t(n)}}function i(e){try{c(o.throw(e))}catch(n){t(n)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,i)}c((o=o.apply(r,[])).next())}));var r,a,o}))}))},e.prototype.ngOnDestroy=function(){this.paysafeJsInstance=null},e.\u0275fac=function(t){return new(t||e)(i.Pb(a.a),i.Pb(r.h),i.Pb(r.m))},e.\u0275cmp=i.Jb({type:e,selectors:[["paysafe-tokenization-form-fields"]],inputs:{tokenizationFormGroupName:"tokenizationFormGroupName"},outputs:{tokenizerInitialized:"tokenizerInitialized",cardTokenized:"cardTokenized",cardTokenizationFailed:"cardTokenizationFailed"},features:[i.Bb([],[{provide:r.c,useExisting:r.m}])],decls:30,vars:7,consts:[[1,"input-container"],["mat-input","","type","text","maxlength","60","qa","cc-name",3,"formControl"],[1,"input-error"],[4,"ngIf"],[1,"input-container","card-number-container"],["id","cardNumber","qa","cc-number",1,"dynamic-input"],["id","expiryDate","qa","cc-exp",1,"dynamic-input"],["id","cvv","qa","cc-cvv",1,"dynamic-input"],["mat-input","","onlyNumber","","type","text","maxlength","10","qa","cc-zip",3,"formControl"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"label"),i.Vc(2,"Name on Card"),i.Ub(),i.Qb(3,"input",1),i.Vb(4,"div",2),i.Tc(5,l,2,1,"ng-container",3),i.Ub(),i.Ub(),i.Vb(6,"div",4),i.Vb(7,"label"),i.Vc(8,"Card Number"),i.Ub(),i.Qb(9,"div",5),i.Vb(10,"div",2),i.Tc(11,p,3,2,"ng-container",3),i.Ub(),i.Ub(),i.Vb(12,"div",0),i.Vb(13,"label"),i.Vc(14,"Expiration"),i.Ub(),i.Qb(15,"div",6),i.Vb(16,"div",2),i.Tc(17,m,3,2,"ng-container",3),i.Ub(),i.Ub(),i.Vb(18,"div",0),i.Vb(19,"label"),i.Vc(20,"Security Code"),i.Ub(),i.Qb(21,"div",7),i.Vb(22,"div",2),i.Tc(23,v,3,2,"ng-container",3),i.Ub(),i.Ub(),i.Vb(24,"div",0),i.Vb(25,"label"),i.Vc(26,"Postal Code"),i.Ub(),i.Qb(27,"input",8),i.Vb(28,"div",2),i.Tc(29,k,3,2,"ng-container",3),i.Ub(),i.Ub()),2&e&&(i.Cb(3),i.qc("formControl",t.nameOnCard),i.Cb(2),i.qc("ngIf",t.nameOnCard.touched&&t.nameOnCard.invalid),i.Cb(6),i.qc("ngIf",t.creditCardNumber.touched&&t.creditCardNumber.invalid),i.Cb(6),i.qc("ngIf",t.creditCardExpiration.touched&&t.creditCardExpiration.invalid),i.Cb(6),i.qc("ngIf",t.creditCardCVV.touched&&t.creditCardCVV.invalid),i.Cb(4),i.qc("formControl",t.zipCode),i.Cb(2),i.qc("ngIf",t.zipCode.touched&&t.zipCode.invalid))},directives:[r.d,r.p,o.b,r.v,r.j,c.t],styles:["[_nghost-%COMP%]{display:contents}.input-container[_ngcontent-%COMP%]{flex:1 1 0;min-width:150px}.input-container.card-number-container[_ngcontent-%COMP%]{max-width:300px;min-width:300px}.input-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#656565;font-size:14px;margin-bottom:3px}.input-container[_ngcontent-%COMP%]   .dynamic-input[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:36px;width:100%;border-radius:5px;border-width:1px;padding:8px 10px}.input-container[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:#e74c3c;font-size:12px;height:18px}.dynamic-input[_ngcontent-%COMP%]{border:1px solid #656565}"]}),e}()},j4OF:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("77kw"),r=n("qEEV"),a=n("LRne"),o=n("lJxs"),c=n("fXoL"),s=function(){function e(e,t){this.apiService=e,this.errorDialogService=t}return e.prototype.getSettings=function(){var e=this;return this.cachedSettings?Object(a.a)(this.cachedSettings):this.apiService.getCardConnectSettings().pipe(Object(o.a)((function(t){if(e.areApiResponsesValid([t]))return e.cachedSettings=t.data,e.cachedSettings})))},e.prototype.areApiResponsesValid=function(e){for(var t=0,n=e;t<n.length;t++)if(!this.isApiResponseValid(n[t]))return!1;return!0},e.prototype.isApiResponseValid=function(e){if(!e)throw new Error("The API failed to respond.");return!e.error||(this.errorDialogService.openHandledErrorDialog(e.statusMessage),!1)},e.\u0275fac=function(t){return new(t||e)(c.ac(i.a),c.ac(r.a))},e.\u0275prov=c.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},j4xm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=n("3Pt+").J.pattern(/^(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-zA-Z0-9-]*[a-zA-Z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/)},"m/eF":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("fXoL"),r=function(){function e(){}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[],imports:[[]]}),e}()},"pE+g":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i,r,a,o=n("77kw"),c=n("qEEV"),s=n("p20J"),l=n("cp0P"),u=n("LRne"),d=n("lJxs"),p=n("lTCR"),h=n.n(p),f=n("qxfD"),m=n("Z7eK"),b=n("fXoL"),g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},v=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((i=i.apply(e,t||[])).next())}))},C=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(c){a=[6,c],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},y=function(){function e(e,t,n,i,r){this.apiService=e,this.errorDialogService=t,this.snackBar=n,this.appSyncService=i,this.appSyncUrlService=r}return e.prototype.getSettings=function(){var e=this;return this.cachedPaysafeSettings?Object(u.a)(this.cachedPaysafeSettings):Object(l.a)([this.apiService.getPaysafeSettings(),this.apiService.getPaysafeDeviceList()]).pipe(Object(d.a)((function(t){if(e.areApiResponsesValid(t))return e.cachedPaysafeSettings={paysafeSettings:t[0].data,paysafeDevices:t[1].data},e.cachedPaysafeSettings})))},e.prototype.saveSettings=function(e){var t=this;return Object(l.a)([this.apiService.savePaysafeSettings(e.paysafeSettings),this.apiService.savePaysafeDeviceList(e.paysafeDevices)]).pipe(Object(d.a)((function(e){if(t.areApiResponsesValid(e))return t.snackBar.open("Paysafe settings and devices saved.","",{duration:5e3}),t.cachedPaysafeSettings={paysafeSettings:e[0].data,paysafeDevices:e[1].data},t.cachedPaysafeSettings})))},e.prototype.getDeviceListFromPaysafe=function(e){return v(this,void 0,void 0,(function(){var t,n,r,a;return C(this,(function(o){switch(o.label){case 0:t=h()(i||(i=g(["\n            query Query {\n                getDevices {\n                    serialNumber\n                    terminalType\n                }\n            }\n        "],["\n            query Query {\n                getDevices {\n                    serialNumber\n                    terminalType\n                }\n            }\n        "]))),n={headers:{"device-api-key":e.toLocaleUpperCase()}},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.appSyncUrlService.get()];case 2:return r=o.sent(),[4,this.appSyncService.getClient(r).query({query:t,context:n,errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return[2,o.sent().data.getDevices];case 4:if((a=o.sent()).message.includes("400")&&a.message.includes("api key"))throw new Error("Invalid device api key");throw console.error(a),new Error("Validation failed, please re-enter");case 5:return[2]}}))}))},e.prototype.isVerifiedMerchantID=function(e){var t,n;return v(this,void 0,void 0,(function(){var i,a,o;return C(this,(function(c){switch(c.label){case 0:return i=!1,[4,this.appSyncUrlService.get()];case 1:a=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.appSyncService.getClient(a).query({query:h()(r||(r=g(["\n                        query Query($merchantID: ID!) {\n                            verifyMerchant(merchantID: $merchantID)\n                        }\n                    "],["\n                        query Query($merchantID: ID!) {\n                            verifyMerchant(merchantID: $merchantID)\n                        }\n                    "]))),variables:{merchantID:e},errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return i=null===(n=null===(t=c.sent())||void 0===t?void 0:t.data)||void 0===n?void 0:n.verifyMerchant,[3,5];case 4:if(!(o=c.sent()).message.includes("400"))throw new Error(o.message?o.message:"");return[3,5];case 5:return[2,i]}}))}))},e.prototype.pingPaysafeDevice=function(e,t,n){return v(this,void 0,void 0,(function(){var i,r,o,c;return C(this,(function(s){switch(s.label){case 0:i=h()(a||(a=g(['\n            query Query {\n                pingDevice(terminalType: "','", serialNumber: "','") {\n                    connectionStatus\n                }\n            }\n        '],['\n            query Query {\n                pingDevice(terminalType: "','", serialNumber: "','") {\n                    connectionStatus\n                }\n            }\n        '])),t,n),r={headers:{"device-api-key":e}},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this.appSyncUrlService.get()];case 2:return o=s.sent(),[4,this.appSyncService.getClient(o).query({query:i,context:r,errorPolicy:"none",fetchPolicy:"no-cache"})];case 3:return[2,s.sent().data.pingDevice];case 4:if((c=s.sent()).message.includes("400")&&c.message.includes("api key"))throw new Error("Invalid device api key");throw new Error("Error occurred, please try again.");case 5:return[2]}}))}))},e.prototype.areApiResponsesValid=function(e){for(var t=0,n=e;t<n.length;t++)if(!this.isApiResponseValid(n[t]))return!1;return!0},e.prototype.isApiResponseValid=function(e){if(!e)throw new Error("The API failed to respond.");return!e.error||(this.errorDialogService.openHandledErrorDialog(e.statusMessage),!1)},e.\u0275fac=function(t){return new(t||e)(b.ac(o.a),b.ac(c.a),b.ac(s.a),b.ac(f.a),b.ac(m.a))},e.\u0275prov=b.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},rQSo:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("+0xr"),r=n("fXoL"),a=n("ofXK"),o=n("ccMj");function c(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"label"),r.Vc(2),r.Ub(),r.Vb(3,"i",8),r.Vc(4," expand_more "),r.Ub(),r.Ub()),2&e){var n=r.ic();r.Cb(2),r.Wc(n.title)}}function s(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"span",9),r.Vc(2),r.Ub(),r.Ub()),2&e){var n=r.ic();r.Cb(2),r.Wc(n.noResultText)}}function l(e,t){if(1&e&&(r.Vb(0,"mat-header-cell",13),r.Vc(1),r.Ub()),2&e){var n=r.ic().$implicit;r.Cb(1),r.Xc(" ",n.action?"Action":n," ")}}function u(e,t){if(1&e&&(r.Qb(0,"span",17),r.jc(1,"currency")),2&e){var n=r.ic().$implicit,i=r.ic().index,a=r.ic();r.qc("innerHTML",a.displayedColumns[i].indexOf("Date")<0?a.displayedColumns[i].indexOf("Price")<0?n[a.displayedColumns[i]]:r.kc(1,1,n[a.displayedColumns[i]]):n[a.displayedColumns[i]],r.Ic)}}function d(e,t){if(1&e&&(r.Vb(0,"a",18),r.Vc(1),r.Ub()),2&e){var n=r.ic(2).$implicit;r.Cb(1),r.Xc(" ",n&&n.action?n.actionName:"","")}}function p(e,t){if(1&e&&(r.Vb(0,"mat-cell",14),r.Tc(1,u,2,3,"span",15),r.Tc(2,d,2,1,"ng-template",null,16,r.Uc),r.Ub()),2&e){var n=r.Dc(3),i=r.ic().index,a=r.ic();r.sc("qa","cell ",i,""),r.Cb(1),r.qc("ngIf","Action"!==a.displayedColumns[i])("ngIfElse",n)}}function h(e,t){if(1&e&&(r.Tb(0,10),r.Tc(1,l,2,1,"mat-header-cell",11),r.Tc(2,p,4,3,"mat-cell",12),r.Sb()),2&e){var n=t.index,i=r.ic();r.qc("matColumnDef",i.displayedColumns[n])}}function f(e,t){1&e&&r.Qb(0,"mat-header-row")}function m(e,t){1&e&&r.Qb(0,"mat-row",19)}var b=function(){function e(){this.noResultText="No recent transactions found",this.listHeader=[]}return Object.defineProperty(e.prototype,"updateInternalVal",{set:function(e){e&&(this.tableDataSource=new i.p(e))},enumerable:!1,configurable:!0}),e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Jb({type:e,selectors:[["client-smart-list"]],inputs:{title:"title",noResultText:"noResultText",list:"list",listHeader:"listHeader",displayedColumns:"displayedColumns",customClass:"customClass",updateInternalVal:["list","updateInternalVal"]},decls:10,vars:8,consts:[[1,"col-lg-12","col-md-12","appointments-list",3,"ngClass"],[4,"ngIf"],[3,"hidden"],[3,"dataSource"],["listTable",""],[3,"matColumnDef",4,"ngFor","ngForOf"],[4,"matHeaderRowDef"],["qa","list-row",4,"matRowDef","matRowDefColumns"],[1,"material-icons"],[1,"no-result"],[3,"matColumnDef"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"qa",4,"matCellDef"],["mat-sort-header",""],[3,"qa"],[3,"innerHTML",4,"ngIf","ngIfElse"],["action",""],[3,"innerHTML"],["href","#"],["qa","list-row"]],template:function(e,t){1&e&&(r.Vb(0,"div",0),r.Tc(1,c,5,1,"div",1),r.Vb(2,"div"),r.Tc(3,s,3,1,"div",1),r.Vb(4,"div",2),r.Vb(5,"mat-table",3,4),r.Tc(7,h,3,1,"ng-container",5),r.Tc(8,f,1,0,"mat-header-row",6),r.Tc(9,m,1,0,"mat-row",7),r.Ub(),r.Ub(),r.Ub(),r.Ub()),2&e&&(r.qc("ngClass",t.customClass),r.Cb(1),r.qc("ngIf",t.title),r.Cb(2),r.qc("ngIf",t.tableDataSource&&0===t.tableDataSource.data.length),r.Cb(1),r.qc("hidden",!t.tableDataSource||0===t.tableDataSource.data.length),r.Cb(1),r.qc("dataSource",t.tableDataSource),r.Cb(2),r.qc("ngForOf",t.listHeader),r.Cb(1),r.qc("matHeaderRowDef",t.displayedColumns),r.Cb(1),r.qc("matRowDefColumns",t.displayedColumns))},directives:[a.q,a.t,i.o,a.s,i.k,i.n,i.c,i.i,i.b,i.h,i.a,o.b,i.j,i.m],pipes:[a.d],styles:[".appointments-list[_ngcontent-%COMP%]{margin-top:25px}.appointments-list[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{vertical-align:middle}.appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-header-row[_ngcontent-%COMP%], .appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-row[_ngcontent-%COMP%]{min-height:30px;border:none;align-items:start}.appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]:first-child, .appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-footer-cell[_ngcontent-%COMP%]:first-child, .appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:first-child{padding-left:0}.appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .appointments-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{font-weight:400;font-size:1.25rem;line-height:1.5}.appointments-list[_ngcontent-%COMP%]   .no-result[_ngcontent-%COMP%]{font-size:1.25rem;color:#707070}.appointments-list[_ngcontent-%COMP%]   .inline-spinner[_ngcontent-%COMP%]{top:9px}.side-nav-client-list[_ngcontent-%COMP%]{padding:0;margin:0}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]{font-family:DM Sans,Arial,sans-serif}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-header-row[_ngcontent-%COMP%], .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-row[_ngcontent-%COMP%]{min-height:20px;border:none;align-items:start}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]:first-child, .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-footer-cell[_ngcontent-%COMP%]:first-child, .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:first-child{padding-left:0}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{color:#141414}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{color:#707070}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{font-weight:400;font-size:15px;line-height:15px}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%] > .mat-header-cell[_ngcontent-%COMP%]:last-child, .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%] > .mat-cell[_ngcontent-%COMP%]:last-child{padding-right:0;max-width:30%}.side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%] > .mat-header-cell[_ngcontent-%COMP%]:first-child, .side-nav-client-list[_ngcontent-%COMP%]   mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%] > .mat-cell[_ngcontent-%COMP%]:first-child{max-width:100px}"]}),e}()},sUfS:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("ofXK"),r=n("f0Cb"),a=n("3Pt+"),o=n("bTqV"),c=n("+0xr"),s=n("NFeN"),l=n("HDqe"),u=n("Xa2L"),d=n("1LWA"),p=n("vyDZ"),h=n("fXoL"),f=function(){function e(){}return e.\u0275mod=h.Nb({type:e}),e.\u0275inj=h.Mb({factory:function(t){return new(t||e)},imports:[[i.c,a.F,r.b,o.c,c.q,s.b,l.c,u.b,d.a,p.a]]}),e}(),m=n("Kbva"),b=function(){function e(){}return e.\u0275mod=h.Nb({type:e}),e.\u0275inj=h.Mb({factory:function(t){return new(t||e)},imports:[[i.c,a.F,r.b,o.c,c.q,s.b,l.c,u.b,m.a,p.a]]}),e}(),g=function(){function e(){}return e.\u0275mod=h.Nb({type:e}),e.\u0275inj=h.Mb({factory:function(t){return new(t||e)},imports:[[i.c,f,b]]}),e}()},tmjD:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return _}));var i=n("RQB8"),r=n.n(i),a=n("t9bE"),o=n("KUzl"),c=n("mvVQ"),s=n("/E8u"),l=n("95OS"),u=n("MGFw"),d=n("WtWf"),p=n("fXoL"),h=n("3Pt+"),f=n("ofXK"),m=new p.s("config"),b=new p.s("NEW_CONFIG"),g=new p.s("INITIAL_CONFIG"),v={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:".",clearIfNotMatch:!1,showTemplate:!1,showMaskTyped:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:void 0,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},C=["Hh:m0:s0","Hh:m0","m0:s0"],y=["percent","Hh","s0","m0","separator","d0/M0/0000","d0/M0","d0","M0"],k=function(){var e=function(){function e(t){var n=this;Object(u.a)(this,e),this._config=t,this.maskExpression="",this.actualValue="",this.shownMaskExpression="",this._formatWithSeparators=function(e,t,i,r){var a=e.split(i),o=a.length>1?"".concat(i).concat(a[1]):"",c=a[0],s=n.separatorLimit.replace(/\s/g,"");s&&+s&&(c="-"===c[0]?"-".concat(c.slice(1,c.length).slice(0,s.length)):c.slice(0,s.length));for(var l=/(\d+)(\d{3})/;t&&l.test(c);)c=c.replace(l,"$1"+t+"$2");return void 0===r?c+o:0===r?c:c+o.substr(0,r+1)},this.percentage=function(e){return Number(e)>=0&&Number(e)<=100},this.getPrecision=function(e){var t=e.split(".");return t.length>1?Number(t[t.length-1]):1/0},this.checkAndRemoveSuffix=function(e){for(var t,i,r,a=(null===(t=n.suffix)||void 0===t?void 0:t.length)-1;a>=0;a--){var o=n.suffix.substr(a,null===(i=n.suffix)||void 0===i?void 0:i.length);if(e.includes(o)&&(a-1<0||!e.includes(n.suffix.substr(a-1,null===(r=n.suffix)||void 0===r?void 0:r.length))))return e.replace(o,"")}return e},this.checkInputPrecision=function(e,t,i){if(t<1/0){var r=new RegExp(n._charToRegExpExpression(i)+"\\d{".concat(t,"}.*$")),a=e.match(r);a&&a[0].length-1>t&&(e=e.substring(0,e.length-(a[0].length-1-t))),0===t&&e.endsWith(i)&&(e=e.substring(0,e.length-1))}return e},this._shift=new Set,this.clearIfNotMatch=this._config.clearIfNotMatch,this.dropSpecialCharacters=this._config.dropSpecialCharacters,this.maskSpecialCharacters=this._config.specialCharacters,this.maskAvailablePatterns=this._config.patterns,this.prefix=this._config.prefix,this.suffix=this._config.suffix,this.thousandSeparator=this._config.thousandSeparator,this.decimalMarker=this._config.decimalMarker,this.hiddenInput=this._config.hiddenInput,this.showMaskTyped=this._config.showMaskTyped,this.placeHolderCharacter=this._config.placeHolderCharacter,this.validation=this._config.validation,this.separatorLimit=this._config.separatorLimit,this.allowNegativeNumbers=this._config.allowNegativeNumbers,this.leadZeroDateTime=this._config.leadZeroDateTime}return Object(d.a)(e,[{key:"applyMaskWithPattern",value:function(e,t){var n=Object(l.a)(t,2),i=n[0];return this.customPattern=n[1],this.applyMask(e,i)}},{key:"applyMask",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){};if(null==e||void 0===t)return"";var c=0,s="",l=!1,u=!1,d=1,p=!1;e.slice(0,this.prefix.length)===this.prefix&&(e=e.slice(this.prefix.length,e.length)),this.suffix&&(null==e?void 0:e.length)>0&&(e=this.checkAndRemoveSuffix(e));var h=e.toString().split("");"IP"===t&&(this.ipError=!!(h.filter((function(e){return"."===e})).length<3&&h.length<7),t="099.099.099.099");for(var f=[],m=0;m<e.length;m++)e[m].match("\\d")&&f.push(e[m]);if("CPF_CNPJ"===t&&(this.cpfCnpjError=!(11===f.length||14===f.length),t=f.length>11?"00.000.000/0000-00":"000.000.000-00"),t.startsWith("percent")){if(e.match("[a-z]|[A-Z]")||e.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)){e=this._stripToDecimal(e);var b=this.getPrecision(t);e=this.checkInputPrecision(e,b,this.decimalMarker)}if(e.indexOf(".")>0&&!this.percentage(e.substring(0,e.indexOf(".")))){var g=e.substring(0,e.indexOf(".")-1);e="".concat(g).concat(e.substring(e.indexOf("."),e.length))}s=this.percentage(e)?e:e.substring(0,e.length-1)}else if(t.startsWith("separator")){(e.match("[w\u0430-\u044f\u0410-\u042f]")||e.match("[\u0401\u0451\u0410-\u044f]")||e.match("[a-z]|[A-Z]")||e.match(/[-@#!$%\\^&*()_\xa3\xac'+|~=`{}\[\]:";<>.?\/]/)||e.match("[^A-Za-z0-9,]"))&&(e=this._stripToDecimal(e)),e=e.length>1&&"0"===e[0]&&e[1]!==this.decimalMarker&&!a?e.slice(1,e.length):e;var v=this._charToRegExpExpression(this.thousandSeparator),C=this._charToRegExpExpression(this.decimalMarker),y='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(v,"").replace(C,""),k=new RegExp("["+y+"]");e.match(k)&&(e=e.substring(0,e.length-1));var x=this.getPrecision(t),S=(e=this.checkInputPrecision(e,x,this.decimalMarker)).replace(new RegExp(v,"g"),""),_=(s=this._formatWithSeparators(S,this.thousandSeparator,this.decimalMarker,x)).indexOf(",")-e.indexOf(","),w=s.length-e.length;if(w>0&&","!==s[i]){u=!0;var P=0;do{this._shift.add(i+P),P++}while(P<w)}else 0!==_&&i>0&&!(s.indexOf(",")>=i&&i>3)||!(s.indexOf(".")>=i&&i>3)&&w<=0?(this._shift.clear(),u=!0,d=w,this._shift.add(i+=w)):this._shift.clear()}else for(var M=0,O=h[0];M<h.length&&c!==t.length;O=h[++M])if(this._checkSymbolMask(O,t[c])&&"?"===t[c+1])s+=O,c+=2;else if("*"===t[c+1]&&l&&this._checkSymbolMask(O,t[c+2]))s+=O,c+=3,l=!1;else if(this._checkSymbolMask(O,t[c])&&"*"===t[c+1])s+=O,l=!0;else if("?"===t[c+1]&&this._checkSymbolMask(O,t[c+2]))s+=O,c+=3;else if(this._checkSymbolMask(O,t[c])){if("H"===t[c]&&Number(O)>2){this._shiftStep(t,c+=1,h.length),M--,this.leadZeroDateTime&&(s+="0");continue}if("h"===t[c]&&"2"===s&&Number(O)>3){c+=1,M--;continue}if("m"===t[c]&&Number(O)>5){this._shiftStep(t,c+=1,h.length),M--,this.leadZeroDateTime&&(s+="0");continue}if("s"===t[c]&&Number(O)>5){this._shiftStep(t,c+=1,h.length),M--,this.leadZeroDateTime&&(s+="0");continue}var V=31;if("d"===t[c]&&(Number(O)>3&&this.leadZeroDateTime||Number(e.slice(c,c+2))>V||"/"===e[c+1])){this._shiftStep(t,c+=1,h.length),M--,this.leadZeroDateTime&&(s+="0");continue}if("M"===t[c]){var I=12,D=0===c&&(Number(O)>2||Number(e.slice(c,c+2))>I||"/"===e[c+1]),T=e.slice(c-3,c-1).includes("/")&&("/"===e[c-2]&&Number(e.slice(c-1,c+1))>I&&"/"!==e[c]||"/"===e[c]||"/"===e[c-3]&&Number(e.slice(c-2,c))>I&&"/"!==e[c-1]||"/"===e[c-1]),E=Number(e.slice(c-3,c-1))<=V&&!e.slice(c-3,c-1).includes("/")&&"/"===e[c-1]&&(Number(e.slice(c,c+2))>I||"/"===e[c+1]),q=Number(e.slice(c-3,c-1))>V&&!e.slice(c-3,c-1).includes("/")&&!e.slice(c-2,c).includes("/")&&Number(e.slice(c-2,c))>I,A=Number(e.slice(c-3,c-1))<=V&&!e.slice(c-3,c-1).includes("/")&&"/"!==e[c-1]&&Number(e.slice(c-1,c+1))>I;if(Number(O)>1&&this.leadZeroDateTime||D||T||E||q||A){this._shiftStep(t,c+=1,h.length),M--,this.leadZeroDateTime&&(s+="0");continue}}s+=O,c++}else-1!==this.maskSpecialCharacters.indexOf(t[c])?(s+=t[c],c++,this._shiftStep(t,c,h.length),M--):this.maskSpecialCharacters.indexOf(O)>-1&&this.maskAvailablePatterns[t[c]]&&this.maskAvailablePatterns[t[c]].optional?(h[c]&&"099.099.099.099"!==t&&"000.000.000-00"!==t&&"00.000.000/0000-00"!==t&&(s+=h[c]),c++,M--):"*"===this.maskExpression[c+1]&&this._findSpecialChar(this.maskExpression[c+2])&&this._findSpecialChar(O)===this.maskExpression[c+2]&&l||"?"===this.maskExpression[c+1]&&this._findSpecialChar(this.maskExpression[c+2])&&this._findSpecialChar(O)===this.maskExpression[c+2]&&l?(c+=3,s+=O):this.showMaskTyped&&this.maskSpecialCharacters.indexOf(O)<0&&O!==this.placeHolderCharacter&&(p=!0);s.length+1===t.length&&-1!==this.maskSpecialCharacters.indexOf(t[t.length-1])&&(s+=t[t.length-1]);for(var U=i+1;this._shift.has(U);)d++,U++;var N=r?c:this._shift.has(i)?d:0;p&&N--,o(N,u),d<0&&this._shift.clear();var R=!1;a&&(R=h.every((function(e){return n.maskSpecialCharacters.includes(e)})));var z="".concat(this.prefix).concat(R?"":s).concat(this.suffix);return 0===s.length&&(z="".concat(this.prefix).concat(s)),z}},{key:"_findSpecialChar",value:function(e){return this.maskSpecialCharacters.find((function(t){return t===e}))}},{key:"_checkSymbolMask",value:function(e,t){return this.maskAvailablePatterns=this.customPattern?this.customPattern:this.maskAvailablePatterns,this.maskAvailablePatterns[t]&&this.maskAvailablePatterns[t].pattern&&this.maskAvailablePatterns[t].pattern.test(e)}},{key:"_stripToDecimal",value:function(e){var t=this;return e.split("").filter((function(e,n){return e.match("^-?\\d")||e.match("\\s")||"."===e||","===e||"-"===e&&0===n&&t.allowNegativeNumbers})).join("")}},{key:"_charToRegExpExpression",value:function(e){return e?" "===e?"\\s":"[\\^$.|?*+()".indexOf(e)>=0?"\\"+e:e:e}},{key:"_shiftStep",value:function(e,t,n){var i=/[*?]/g.test(e.slice(0,t))?n:t;this._shift.add(i+this.prefix.length||0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(p.ac(m))},e.\u0275prov=p.Lb({token:e,factory:e.\u0275fac}),e}(),x=function(){var e=function(e){Object(c.a)(n,e);var t=Object(s.a)(n);function n(e,i,r,a){var o;return Object(u.a)(this,n),(o=t.call(this,i)).document=e,o._config=i,o._elementRef=r,o._renderer=a,o.maskExpression="",o.isNumberValue=!1,o.placeHolderCharacter="_",o.maskIsShown="",o.selStart=null,o.selEnd=null,o.writingValue=!1,o.maskChanged=!1,o.onChange=function(e){},o}return Object(d.a)(n,[{key:"applyMask",value:function(e,t){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){};if(!t)return e;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():"","IP"===this.maskExpression&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(e||"#")),"CPF_CNPJ"===this.maskExpression&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(e||"#")),!e&&this.showMaskTyped)return this.formControlResult(this.prefix),this.prefix+this.maskIsShown;var u=e&&"number"==typeof this.selStart?e[this.selStart]:"",d="";if(this.hiddenInput&&!this.writingValue){var p=this.actualValue.split("");""!==e&&p.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(e.length>p.length?p.splice(this.selStart,0,u):e.length<p.length&&(p.length-e.length==1?p.splice(this.selStart-1,1):p.splice(this.selStart,this.selEnd-this.selStart))):p=[],d=this.actualValue.length&&p.length<=e.length?this.shiftTypedSymbols(p.join("")):e}d=Boolean(d)&&d.length?d:e;var h=Object(a.a)(Object(o.a)(n.prototype),"applyMask",this).call(this,d,t,r,c,s,l);if(this.actualValue=this.getActualValue(h),"."===this.thousandSeparator&&"."===this.decimalMarker&&(this.decimalMarker=","),this.maskExpression.startsWith("separator")&&!0===this.dropSpecialCharacters&&(this.maskSpecialCharacters=this.maskSpecialCharacters.filter((function(e){return e!==i.decimalMarker}))),this.formControlResult(h),!this.showMaskTyped)return this.hiddenInput&&h&&h.length?this.hideInput(h,this.maskExpression):h;var f=h.length,m=this.prefix+this.maskIsShown;if(this.maskExpression.includes("H")){var b=this._numberSkipedSymbols(h);return h+m.slice(f+b)}return"IP"===this.maskExpression||"CPF_CNPJ"===this.maskExpression?h+m:h+m.slice(f)}},{key:"_numberSkipedSymbols",value:function(e){for(var t=/(^|\D)(\d\D)/g,n=t.exec(e),i=0;null!=n;)i+=1,n=t.exec(e);return i}},{key:"applyValueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=this._elementRef.nativeElement;r.value=this.applyMask(r.value,this.maskExpression,e,t,n,i),r!==this.document.activeElement&&this.clearIfNotMatchFn()}},{key:"hideInput",value:function(e,t){var n=this;return e.split("").map((function(e,i){return n.maskAvailablePatterns&&n.maskAvailablePatterns[t[i]]&&n.maskAvailablePatterns[t[i]].symbol?n.maskAvailablePatterns[t[i]].symbol:e})).join("")}},{key:"getActualValue",value:function(e){var t=this,n=e.split("").filter((function(e,n){return t._checkSymbolMask(e,t.maskExpression[n])||t.maskSpecialCharacters.includes(t.maskExpression[n])&&e===t.maskExpression[n]}));return n.join("")===e?n.join(""):e}},{key:"shiftTypedSymbols",value:function(e){var t=this,n="";return(e&&e.split("").map((function(i,r){if(t.maskSpecialCharacters.includes(e[r+1])&&e[r+1]!==t.maskExpression[r+1])return n=i,e[r+1];if(n.length){var a=n;return n="",a}return i}))||[]).join("")}},{key:"showMaskInInput",value:function(e){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}if(this.showMaskTyped){if(e){if("IP"===this.maskExpression)return this._checkForIp(e);if("CPF_CNPJ"===this.maskExpression)return this._checkForCpfCnpj(e)}return this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}},{key:"clearIfNotMatchFn",value:function(){var e=this._elementRef.nativeElement;this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==e.value.replace(/_/g,"").length&&(this.formElementProperty=["value",""],this.applyMask(e.value,this.maskExpression))}},{key:"checkSpecialCharAmount",value:function(e){var t=this;return e.split("").filter((function(e){return t._findSpecialChar(e)})).length}},{key:"removeMask",value:function(e){return this._removeMask(this._removeSuffix(this._removePrefix(e)),this.maskSpecialCharacters.concat("_").concat(this.placeHolderCharacter))}},{key:"_checkForIp",value:function(e){if("#"===e)return"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter);for(var t=[],n=0;n<e.length;n++)e[n].match("\\d")&&t.push(e[n]);return t.length<=3?"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter):t.length>3&&t.length<=6?"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter):t.length>6&&t.length<=9?this.placeHolderCharacter:""}},{key:"_checkForCpfCnpj",value:function(e){var t="".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+".".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+".".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+"-".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter),n="".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+".".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+".".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+"/".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter).concat(this.placeHolderCharacter)+"-".concat(this.placeHolderCharacter).concat(this.placeHolderCharacter);if("#"===e)return t;for(var i=[],r=0;r<e.length;r++)e[r].match("\\d")&&i.push(e[r]);return i.length<=3?t.slice(i.length,t.length):i.length>3&&i.length<=6?t.slice(i.length+1,t.length):i.length>6&&i.length<=9?t.slice(i.length+2,t.length):i.length>9&&i.length<11?t.slice(i.length+3,t.length):11===i.length?"":12===i.length?n.slice(17===e.length?16:15,n.length):i.length>12&&i.length<=14?n.slice(i.length+4,n.length):""}},{key:"formControlResult",value:function(e){this.writingValue||this.maskChanged?this.maskChanged=!1:Array.isArray(this.dropSpecialCharacters)?this.onChange(this._toNumber(this._removeMask(this._removeSuffix(this._removePrefix(e)),this.dropSpecialCharacters))):this.onChange(this.dropSpecialCharacters?this._toNumber(this._checkSymbols(e)):this._removeSuffix(e))}},{key:"_toNumber",value:function(e){if(!this.isNumberValue||""===e)return e;var t=Number(e);return Number.isNaN(t)?e:t}},{key:"_removeMask",value:function(e,t){return e?e.replace(this._regExpForRemove(t),""):e}},{key:"_removePrefix",value:function(e){return this.prefix&&e?e.replace(this.prefix,""):e}},{key:"_removeSuffix",value:function(e){return this.suffix&&e?e.replace(this.suffix,""):e}},{key:"_retrieveSeparatorValue",value:function(e){return this._removeMask(this._removeSuffix(this._removePrefix(e)),this.maskSpecialCharacters)}},{key:"_regExpForRemove",value:function(e){return new RegExp(e.map((function(e){return"\\".concat(e)})).join("|"),"gi")}},{key:"_checkSymbols",value:function(e){if(""===e)return e;var t=this._retrieveSeparatorPrecision(this.maskExpression),n=this._retrieveSeparatorValue(e);return"."!==this.decimalMarker&&(n=n.replace(this.decimalMarker,".")),this.isNumberValue?t?e===this.decimalMarker?null:this._checkPrecision(this.maskExpression,n):Number(n):n}},{key:"_retrieveSeparatorPrecision",value:function(e){var t=e.match(new RegExp("^separator\\.([^d]*)"));return t?Number(t[1]):null}},{key:"_checkPrecision",value:function(e,t){return e.indexOf("2")>0?Number(t).toFixed(2):Number(t)}},{key:"formElementProperty",set:function(e){var t=this,n=Object(l.a)(e,2),i=n[0],r=n[1];Promise.resolve().then((function(){return t._renderer.setProperty(t._elementRef.nativeElement,i,r)}))}}]),n}(k);return e.\u0275fac=function(t){return new(t||e)(p.ac(f.e),p.ac(m),p.ac(p.l),p.ac(p.G))},e.\u0275prov=p.Lb({token:e,factory:e.\u0275fac}),e}(),S=function(){var e=function(){function e(t,n,i){Object(u.a)(this,e),this.document=t,this._maskService=n,this._config=i,this.maskExpression="",this.specialCharacters=[],this.patterns={},this.prefix="",this.suffix="",this.thousandSeparator=" ",this.decimalMarker=".",this.dropSpecialCharacters=null,this.hiddenInput=null,this.showMaskTyped=null,this.placeHolderCharacter=null,this.shownMaskExpression=null,this.showTemplate=null,this.clearIfNotMatch=null,this.validation=null,this.separatorLimit=null,this.allowNegativeNumbers=null,this.leadZeroDateTime=null,this._maskValue="",this._position=null,this._maskExpressionArray=[],this._justPasted=!1,this.onChange=function(e){},this.onTouch=function(){}}return Object(d.a)(e,[{key:"ngOnChanges",value:function(e){var t=e.maskExpression,n=e.specialCharacters,i=e.patterns,r=e.prefix,a=e.suffix,o=e.thousandSeparator,c=e.decimalMarker,s=e.dropSpecialCharacters,l=e.hiddenInput,u=e.showMaskTyped,d=e.placeHolderCharacter,p=e.shownMaskExpression,h=e.showTemplate,f=e.clearIfNotMatch,m=e.validation,b=e.separatorLimit,g=e.allowNegativeNumbers,v=e.leadZeroDateTime;if(t&&(t.currentValue===t.previousValue||t.firstChange||(this._maskService.maskChanged=!0),this._maskValue=t.currentValue||"",t.currentValue&&t.currentValue.split("||").length>1&&(this._maskExpressionArray=t.currentValue.split("||").sort((function(e,t){return e.length-t.length})),this._maskValue=this._maskExpressionArray[0],this.maskExpression=this._maskExpressionArray[0],this._maskService.maskExpression=this._maskExpressionArray[0])),n){if(!n.currentValue||!Array.isArray(n.currentValue))return;this._maskService.maskSpecialCharacters=n.currentValue||[]}i&&i.currentValue&&(this._maskService.maskAvailablePatterns=i.currentValue),r&&(this._maskService.prefix=r.currentValue),a&&(this._maskService.suffix=a.currentValue),o&&(this._maskService.thousandSeparator=o.currentValue),c&&(this._maskService.decimalMarker=c.currentValue),s&&(this._maskService.dropSpecialCharacters=s.currentValue),l&&(this._maskService.hiddenInput=l.currentValue),u&&(this._maskService.showMaskTyped=u.currentValue),d&&(this._maskService.placeHolderCharacter=d.currentValue),p&&(this._maskService.shownMaskExpression=p.currentValue),h&&(this._maskService.showTemplate=h.currentValue),f&&(this._maskService.clearIfNotMatch=f.currentValue),m&&(this._maskService.validation=m.currentValue),b&&(this._maskService.separatorLimit=b.currentValue),g&&(this._maskService.allowNegativeNumbers=g.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.maskSpecialCharacters=this._maskService.maskSpecialCharacters.filter((function(e){return"-"!==e})))),v&&(this._maskService.leadZeroDateTime=v.currentValue),this._applyMask()}},{key:"validate",value:function(e){var t=this,n=e.value;if(!this._maskService.validation||!this._maskValue)return null;if(this._maskService.ipError)return this._createValidationError(n);if(this._maskService.cpfCnpjError)return this._createValidationError(n);if(this._maskValue.startsWith("separator"))return null;if(y.includes(this._maskValue))return null;if(this._maskService.clearIfNotMatch)return null;if(C.includes(this._maskValue))return this._validateTime(n);if(n&&n.toString().length>=1){var i=0,r=function(e){if(t._maskService.maskAvailablePatterns[e].optional&&!0===t._maskService.maskAvailablePatterns[e].optional){if(t._maskValue.indexOf(e)!==t._maskValue.lastIndexOf(e)){var r=t._maskValue.split("").filter((function(t){return t===e})).join("");i+=r.length}else-1!==t._maskValue.indexOf(e)&&i++;if(-1!==t._maskValue.indexOf(e)&&n.toString().length>=t._maskValue.indexOf(e))return{v:null};if(i===t._maskValue.length)return{v:null}}};for(var a in this._maskService.maskAvailablePatterns){var o=r(a);if("object"==typeof o)return o.v}if(1===this._maskValue.indexOf("{")&&n.toString().length===this._maskValue.length+Number(this._maskValue.split("{")[1].split("}")[0])-4)return null;if(1===this._maskValue.indexOf("*")||1===this._maskValue.indexOf("?"))return null;if(this._maskValue.indexOf("*")>1&&n.toString().length<this._maskValue.indexOf("*")||this._maskValue.indexOf("?")>1&&n.toString().length<this._maskValue.indexOf("?")||1===this._maskValue.indexOf("{"))return this._createValidationError(n);if(-1===this._maskValue.indexOf("*")||-1===this._maskValue.indexOf("?")){var c=this._maskService.dropSpecialCharacters?this._maskValue.length-this._maskService.checkSpecialCharAmount(this._maskValue)-i:this._maskValue.length-i;if(n.toString().length<c)return this._createValidationError(n)}}return null}},{key:"onPaste",value:function(){this._justPasted=!0}},{key:"onInput",value:function(e){var t=this,n=e.target;if(this._inputValue=n.value,this._setMask(),this._maskValue){var i=1===n.selectionStart?n.selectionStart+this._maskService.prefix.length:n.selectionStart,r=0,a=!1;if(this._maskService.applyValueChanges(i,this._justPasted,"Backspace"===this._code||"Delete"===this._code,(function(e,n){t._justPasted=!1,r=e,a=n})),this.document.activeElement===n){this._position=1===this._position&&1===this._inputValue.length?null:this._position;var o=this._position?this._inputValue.length+i+r:i+("Backspace"!==this._code||a?r:0);o>this._getActualInputLength()&&(o=this._getActualInputLength()),o<0&&(o=0),n.setSelectionRange(o,o),this._position=null}}else this.onChange(n.value)}},{key:"onBlur",value:function(){this._maskValue&&this._maskService.clearIfNotMatchFn(),this.onTouch()}},{key:"onFocus",value:function(e){if(this._maskValue){var t=e.target;null!==t&&null!==t.selectionStart&&t.selectionStart===t.selectionEnd&&t.selectionStart>this._maskService.prefix.length&&38!==e.keyCode&&this._maskService.showMaskTyped&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),t.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===t.value?(t.focus(),t.setSelectionRange(0,0)):t.selectionStart>this._maskService.actualValue.length&&t.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));var n=t.value&&t.value!==this._maskService.prefix?t.value:this._maskService.prefix+this._maskService.maskIsShown;t.value!==n&&(t.value=n),(t.selectionStart||t.selectionEnd)<=this._maskService.prefix.length?t.selectionStart=this._maskService.prefix.length:t.selectionEnd>this._getActualInputLength()&&(t.selectionEnd=this._getActualInputLength())}}},{key:"onKeyDown",value:function(e){var t;if(this._maskValue){this._code=e.code?e.code:e.key;var n=e.target;if(this._inputValue=n.value,this._setMask(),38===e.keyCode&&e.preventDefault(),37===e.keyCode||8===e.keyCode||46===e.keyCode){if(8===e.keyCode&&0===n.value.length&&(n.selectionStart=n.selectionEnd),8===e.keyCode&&0!==n.selectionStart)if(this.specialCharacters=(null===(t=this.specialCharacters)||void 0===t?void 0:t.length)?this.specialCharacters:this._config.specialCharacters,this.prefix.length>1&&n.selectionStart<=this.prefix.length)n.setSelectionRange(this.prefix.length,this.prefix.length);else{if(this._inputValue.length!==n.selectionStart&&1!==n.selectionStart)for(;this.specialCharacters.includes(this._inputValue[n.selectionStart-1].toString())&&(this.prefix.length>=1&&n.selectionStart>this.prefix.length||0===this.prefix.length);)n.setSelectionRange(n.selectionStart-1,n.selectionStart-1);this.suffixCheckOnPressDelete(e.keyCode,n)}this.suffixCheckOnPressDelete(e.keyCode,n),this._maskService.prefix.length&&n.selectionStart<=this._maskService.prefix.length&&n.selectionEnd<=this._maskService.prefix.length&&e.preventDefault(),8!==e.keyCode||n.readOnly||0!==n.selectionStart||n.selectionEnd!==n.value.length||0===n.value.length||(this._position=this._maskService.prefix?this._maskService.prefix.length:0,this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position))}this.suffix&&this.suffix.length>1&&this._inputValue.length-this.suffix.length<n.selectionStart?n.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length):(65===e.keyCode&&!0===e.ctrlKey||65===e.keyCode&&!0===e.metaKey)&&(n.setSelectionRange(0,this._getActualInputLength()),e.preventDefault()),this._maskService.selStart=n.selectionStart,this._maskService.selEnd=n.selectionEnd}}},{key:"writeValue",value:function(e){return t=this,void 0,n=void 0,i=r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"object"==typeof e&&null!==e&&"value"in e&&("disable"in e&&this.setDisabledState(Boolean(e.disable)),e=e.value),void 0===e&&(e=""),"number"==typeof e&&(e=String(e),e="."!==this.decimalMarker?e.replace(".",this.decimalMarker):e,this._maskService.isNumberValue=!0),this._inputValue=e,this._setMask(),e&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?(this._maskService.writingValue=!0,this._maskService.formElementProperty=["value",this._maskService.applyMask(e,this._maskService.maskExpression)],this._maskService.writingValue=!1):this._maskService.formElementProperty=["value",e],this._inputValue=e;case 7:case"end":return t.stop()}}),t,this)})),new(n||(n=Promise))((function(e,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function o(e){try{c(i.throw(e))}catch(t){r(t)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(a,o)}c((i=i.apply(t,[])).next())}));var t,n,i}},{key:"registerOnChange",value:function(e){this.onChange=e,this._maskService.onChange=this.onChange}},{key:"registerOnTouched",value:function(e){this.onTouch=e}},{key:"suffixCheckOnPressDelete",value:function(e,t){46===e&&this.suffix.length>0&&this._inputValue.length-this.suffix.length<=t.selectionStart&&t.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length),8===e&&(this.suffix.length>1&&this._inputValue.length-this.suffix.length<t.selectionStart&&t.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length),1===this.suffix.length&&this._inputValue.length===t.selectionStart&&t.setSelectionRange(t.selectionStart-1,t.selectionStart-1))}},{key:"setDisabledState",value:function(e){this._maskService.formElementProperty=["disabled",e]}},{key:"_repeatPatternSymbols",value:function(e){var t=this;return e.match(/{[0-9]+}/)&&e.split("").reduce((function(n,i,r){if(t._start="{"===i?r:t._start,"}"!==i)return t._maskService._findSpecialChar(i)?n+i:n;t._end=r;var a=Number(e.slice(t._start+1,t._end));return n+new Array(a+1).join(e[t._start-1])}),"")||e}},{key:"_applyMask",value:function(){this._maskService.maskExpression=this._repeatPatternSymbols(this._maskValue||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue,this._maskService.maskExpression)]}},{key:"_validateTime",value:function(e){var t=this._maskValue.split("").filter((function(e){return":"!==e})).length;return e&&(0==+e[e.length-1]&&e.length<t||e.length<=t-2)?this._createValidationError(e):null}},{key:"_getActualInputLength",value:function(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}},{key:"_createValidationError",value:function(e){return{mask:{requiredMask:this._maskValue,actualValue:e}}}},{key:"_setMask",value:function(){var e=this;this._maskExpressionArray.length>0&&this._maskExpressionArray.some((function(t){var n,i,r=(null===(n=e._maskService.removeMask(e._inputValue))||void 0===n?void 0:n.length)<=(null===(i=e._maskService.removeMask(t))||void 0===i?void 0:i.length);if(e._inputValue&&r)return e._maskValue=t,e.maskExpression=t,e._maskService.maskExpression=t,r;e._maskValue=e._maskExpressionArray[e._maskExpressionArray.length-1],e.maskExpression=e._maskExpressionArray[e._maskExpressionArray.length-1],e._maskService.maskExpression=e._maskExpressionArray[e._maskExpressionArray.length-1]}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(p.Pb(f.e),p.Pb(x),p.Pb(m))},e.\u0275dir=p.Kb({type:e,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,t){1&e&&p.ec("paste",(function(){return t.onPaste()}))("input",(function(e){return t.onInput(e)}))("blur",(function(){return t.onBlur()}))("click",(function(e){return t.onFocus(e)}))("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{maskExpression:["mask","maskExpression"],specialCharacters:"specialCharacters",patterns:"patterns",prefix:"prefix",suffix:"suffix",thousandSeparator:"thousandSeparator",decimalMarker:"decimalMarker",dropSpecialCharacters:"dropSpecialCharacters",hiddenInput:"hiddenInput",showMaskTyped:"showMaskTyped",placeHolderCharacter:"placeHolderCharacter",shownMaskExpression:"shownMaskExpression",showTemplate:"showTemplate",clearIfNotMatch:"clearIfNotMatch",validation:"validation",separatorLimit:"separatorLimit",allowNegativeNumbers:"allowNegativeNumbers",leadZeroDateTime:"leadZeroDateTime"},features:[p.Bb([{provide:h.t,useExisting:Object(p.W)((function(){return e})),multi:!0},{provide:h.s,useExisting:Object(p.W)((function(){return e})),multi:!0},x]),p.Ab]}),e}(),_=function(){var e=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:b,useValue:t},{provide:g,useValue:v},{provide:m,useFactory:w,deps:[g,b]},k]}}},{key:"forChild",value:function(){return{ngModule:e}}}]),e}();return e.\u0275mod=p.Nb({type:e}),e.\u0275inj=p.Mb({factory:function(t){return new(t||e)}}),e}();function w(e,t){return Object.assign(Object.assign({},e),t instanceof Function?t():t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self}}]);